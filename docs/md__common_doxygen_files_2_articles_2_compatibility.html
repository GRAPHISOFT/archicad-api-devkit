<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad 28 C++ API: API Compatibility</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#6390f9">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad 28 C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__common_doxygen_files_2_articles_2_compatibility.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">API Compatibility </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="apicompatibility"></a> <b>Summary:</b> This document discusses issues related to add-on compatibility.</p>
<ol type="1">
<li><a class="el" href="md__common_doxygen_files_2_articles_2_compatibility.html#Intro">Introduction</a></li>
<li><a class="el" href="md__common_doxygen_files_2_articles_2_compatibility.html#Interface">Interface</a></li>
<li><a class="el" href="md__common_doxygen_files_2_articles_2_compatibility.html#Library">Library</a></li>
</ol>
<hr  />
<h1><a class="anchor" id="Intro"></a>
Introduction</h1>
<p>For a good summary on (C++) compatibility, see <a href="https://community.kde.org/Policies/Binary_Compatibility_Issues_With_C%2B%2B">this page</a> from the KDE site. We'll use the terms <b>binary</b> and <b>source compatible</b> the way they were defined on that page. The first type is superior (and of course, more valuable) from the developer's point of view, as this doesn't require any work from your side.</p>
<p>As Archicad and its API is written in C++, we do not provide binary compatibility between main Archicad versions because of the interface changes of several modules, so add-ons compiled with older DevKits cannot be loaded in a newer Archicad main version. Add-ons developed for an earlier Archicad must be re-compiled with the new DevKit in order to enable them to run with current Archicad.</p>
<p>This document explains what compatibility means from the add-on developer's point, and what you can do about it.</p>
<hr  />
<h1><a class="anchor" id="Interface"></a>
Interface</h1>
<p>By definition, an interface to a library can only provide source level compatibility. This means that the functionality of the API can only be extended with new functions, and the old functions shouldn't change.</p>
<p>The API (by itself) provides mostly a C interface. This C-like interface is easier to keep source and binary compatible, because the different compilers generate the same code for the same interface. Also, the <code>ACAP_STAT.lib</code> contains a function table, where we add many placeholders to be able to introduce new functions in minor Archicad updates.</p>
<p>If an old function is not relevant any more, then it should still sit there and mimic the behavior it provided in previous versions, as long as this is feasible. This may require serious internal programming effort, as we would have to implement the old functionality internally over a newer set of internal interfaces. If the old functionality is still viable, just requires extra parameters to provide the functionality available in the actual version of Archicad, then we can introduce a new function (much like the ...Ex functions in the Windows platform SDK). In the C interface, in the past we used the filler places in the function table to store the addresses of these functions.</p>
<p>In the C++ world, the (virtual) function table is generated by the compiler, and no filler 'place' exists. So, if we introduce a new function in this interface, then all code linked to this C++ library would suddenly become unusable, and your add-on would not be loaded by Archicad.</p>
<h1><a class="anchor" id="Library"></a>
Library</h1>
<p>The API Development Kit contains the API as a static library, ACAP_STAT.lib. As you link your code to the static library, it provides the main entry points to the add-on (DLL/bundle), and builds up an internal function table where it stores all the addresses of the available functions. This static library also provides a version number for the API interface of Archicad, which can be used internally to provide the expected behavior of the application for an add-on if a subsequent maintenance release appears.</p>
<p>A very important point in the version controlling process is the obligatory <code><a class="el" href="group___add_on_lifetime.html#gaf36d63d09853e5344932b63ee23d2bb9" title="Defines the behavior of the add-on based on the current running environment.">CheckEnvironment()</a></code> function:</p>
<div class="fragment"><div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Dependency definitions</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a class="code hl_enumeration" href="group___add_on_lifetime.html#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a> <a class="code hl_function" href="group___add_on_lifetime.html#gaf36d63d09853e5344932b63ee23d2bb9">CheckEnvironment</a> (<a class="code hl_struct" href="struct_a_p_i___envir_params.html">API_EnvirParams</a>* envir)</div>
<div class="line">{</div>
<div class="line">    RSGetIndString (&amp;envir-&gt;<a class="code hl_variable" href="struct_a_p_i___envir_params.html#a8b40f7bf107aa37c938f3cdab4dcaea9">addOnInfo</a>.<a class="code hl_variable" href="struct_a_p_i___add_on_info.html#adec5e8ab696e64287d6b8a3d6b29dad9">name</a>, 32000, 1, <a class="code hl_function" href="group___resource.html#gaf1228260879fd5622cb1e9a5284e0c50">ACAPI_GetOwnResModule</a> ());</div>
<div class="line">    RSGetIndString (&amp;envir-&gt;<a class="code hl_variable" href="struct_a_p_i___envir_params.html#a8b40f7bf107aa37c938f3cdab4dcaea9">addOnInfo</a>.<a class="code hl_variable" href="struct_a_p_i___add_on_info.html#a805479fbd9889b79de7659344e25481d">description</a>, 32000, 2, <a class="code hl_function" href="group___resource.html#gaf1228260879fd5622cb1e9a5284e0c50">ACAPI_GetOwnResModule</a> ());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> APIAddon_Normal;</div>
<div class="line">}        <span class="comment">// CheckEnvironment</span></div>
<div class="ttc" id="agroup___add_on_lifetime_html_ga7323a17897372b0fc97fcfe0874213f3"><div class="ttname"><a href="group___add_on_lifetime.html#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a></div><div class="ttdeci">API_AddonType</div><div class="ttdoc">Describes the different types of add-ons.</div><div class="ttdef"><b>Definition:</b> APIdefs_Registration.h:253</div></div>
<div class="ttc" id="agroup___add_on_lifetime_html_gaf36d63d09853e5344932b63ee23d2bb9"><div class="ttname"><a href="group___add_on_lifetime.html#gaf36d63d09853e5344932b63ee23d2bb9">CheckEnvironment</a></div><div class="ttdeci">API_AddonType CheckEnvironment(API_EnvirParams *envirParams)</div><div class="ttdoc">Defines the behavior of the add-on based on the current running environment.</div></div>
<div class="ttc" id="agroup___resource_html_gaf1228260879fd5622cb1e9a5284e0c50"><div class="ttname"><a href="group___resource.html#gaf1228260879fd5622cb1e9a5284e0c50">ACAPI_GetOwnResModule</a></div><div class="ttdeci">GSResModule ACAPI_GetOwnResModule(void)</div><div class="ttdoc">Returns the add-on's own resource module identifier for loading resources.</div></div>
<div class="ttc" id="astruct_a_p_i___add_on_info_html_a805479fbd9889b79de7659344e25481d"><div class="ttname"><a href="struct_a_p_i___add_on_info.html#a805479fbd9889b79de7659344e25481d">API_AddOnInfo::description</a></div><div class="ttdeci">GS::UniString description</div><div class="ttdoc">The description of the functionality of the add-on, in Unicode.</div><div class="ttdef"><b>Definition:</b> APIdefs_Registration.h:117</div></div>
<div class="ttc" id="astruct_a_p_i___add_on_info_html_adec5e8ab696e64287d6b8a3d6b29dad9"><div class="ttname"><a href="struct_a_p_i___add_on_info.html#adec5e8ab696e64287d6b8a3d6b29dad9">API_AddOnInfo::name</a></div><div class="ttdeci">GS::UniString name</div><div class="ttdoc">The name of the add-on, in Unicode.</div><div class="ttdef"><b>Definition:</b> APIdefs_Registration.h:111</div></div>
<div class="ttc" id="astruct_a_p_i___envir_params_html"><div class="ttname"><a href="struct_a_p_i___envir_params.html">API_EnvirParams</a></div><div class="ttdoc">Describes the different parameters of the running environment.</div><div class="ttdef"><b>Definition:</b> APIdefs_Registration.h:195</div></div>
<div class="ttc" id="astruct_a_p_i___envir_params_html_a8b40f7bf107aa37c938f3cdab4dcaea9"><div class="ttname"><a href="struct_a_p_i___envir_params.html#a8b40f7bf107aa37c938f3cdab4dcaea9">API_EnvirParams::addOnInfo</a></div><div class="ttdeci">API_AddOnInfo addOnInfo</div><div class="ttdoc">Textual description of the add-on; the add-on should fill this in.</div><div class="ttdef"><b>Definition:</b> APIdefs_Registration.h:207</div></div>
</div><!-- fragment --><p>The <code><a class="el" href="struct_a_p_i___envir_params.html" title="Describes the different parameters of the running environment.">API_EnvirParams</a></code> structure contains the main and the maintenance version of the server application. Based on this information your add-on can decide whether it wants to run in the current server application. For example, a bug has been corrected in the maintenance update of Archicad, which prevented the operation of your add-on in the original major release. In this case you can test the server application's version in the <code><a class="el" href="group___add_on_lifetime.html#gaf36d63d09853e5344932b63ee23d2bb9" title="Defines the behavior of the add-on based on the current running environment.">CheckEnvironment()</a></code> function, and return <code>APIAddon_DontRegister</code> if <code>envir-&gt;serverInfo.releaseVersion</code> doesn't match your need. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
</body>
</html>