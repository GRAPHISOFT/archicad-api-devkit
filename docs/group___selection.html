<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad C++ API: Selection handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="logo.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group___selection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Selection handling</div></div>
</div><!--header-->
<div class="contents">

<p>Functions related to selection and marquee, including selecting elements and listing selected elements or elements included in the marquee.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about the current selection.  <a href="struct_a_p_i___selection_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___marquee_filter.html">API_MarqueeFilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the filter for 3D filter and cut settings.  <a href="struct_a_p_i___marquee_filter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga4db5336458c0ae5199127b2eb3fd4c4f"><td class="memItemLeft" align="right" valign="top">typedef GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___notification.html#ga4db5336458c0ae5199127b2eb3fd4c4f">APISelectionChangeHandlerProc</a>(const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</td></tr>
<tr class="memdesc:ga4db5336458c0ae5199127b2eb3fd4c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">User supplied callback procedure for handling selection changes.  <br /></td></tr>
<tr class="separator:ga4db5336458c0ae5199127b2eb3fd4c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga36f2171ea09f32547154874c2def2c2c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga36f2171ea09f32547154874c2def2c2c">API_SelTypeID</a> { <br />
&#160;&#160;<b>API_SelEmpty</b> = 0
, <b>API_SelElems</b>
, <b>API_MarqueePoly</b>
, <b>API_MarqueeHorBox</b>
, <br />
&#160;&#160;<b>API_MarqueeRotBox</b>
<br />
 }</td></tr>
<tr class="memdesc:ga36f2171ea09f32547154874c2def2c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of the selection.  <a href="group___selection.html#ga36f2171ea09f32547154874c2def2c2c">More...</a><br /></td></tr>
<tr class="separator:ga36f2171ea09f32547154874c2def2c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a> { <b>API_InsidePartially</b> = 0
, <b>API_InsideEntirely</b>
, <b>API_OutsidePartially</b>
, <b>API_OutsideEntirely</b>
 }</td></tr>
<tr class="memdesc:ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of the relative position to marquee criteria.  <a href="group___selection.html#ga494cdce1c162a3399f2dbdd6b68e69d3">More...</a><br /></td></tr>
<tr class="separator:ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9bf76846795b363e9a419a5e9fd3c874"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga9bf76846795b363e9a419a5e9fd3c874">ACAPI_Selection_GetSelectedElement</a> (const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *apiNeig, <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *apiGuid)</td></tr>
<tr class="memdesc:ga9bf76846795b363e9a419a5e9fd3c874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> structure to an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a>.  <br /></td></tr>
<tr class="separator:ga9bf76846795b363e9a419a5e9fd3c874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10730d6017d3c9d5586e97327b211f24"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga10730d6017d3c9d5586e97327b211f24">ACAPI_Selection_SetSelectedElementNeig</a> (const <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *apiGuid, <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *apiNeig)</td></tr>
<tr class="memdesc:ga10730d6017d3c9d5586e97327b211f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> structure to an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>.  <br /></td></tr>
<tr class="separator:ga10730d6017d3c9d5586e97327b211f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8654f0b2ebed30b60e3fc1f8cf9d8bb1"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">ACAPI_Selection_Select</a> (const GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; &amp;selNeigs, bool add)</td></tr>
<tr class="memdesc:ga8654f0b2ebed30b60e3fc1f8cf9d8bb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds/removes a number of elements to/from the current selection.  <br /></td></tr>
<tr class="separator:ga8654f0b2ebed30b60e3fc1f8cf9d8bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a9cd38f6f56812f12bdde57cfc01f91"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga4a9cd38f6f56812f12bdde57cfc01f91">ACAPI_Selection_DeselectAll</a> ()</td></tr>
<tr class="memdesc:ga4a9cd38f6f56812f12bdde57cfc01f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds/removes a number of elements to/from the current selection.  <br /></td></tr>
<tr class="separator:ga4a9cd38f6f56812f12bdde57cfc01f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1301c5bcb61d90998c0b1f97f5c82544"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#ga1301c5bcb61d90998c0b1f97f5c82544">ACAPI_Selection_Get</a> (<a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *selectionInfo, GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; *selNeigs, bool onlyEditable, bool ignorePartialSelection=true, <a class="el" href="group___selection.html#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a> relativePosToMarquee=API_InsidePartially)</td></tr>
<tr class="memdesc:ga1301c5bcb61d90998c0b1f97f5c82544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns information on the selection, and the selected elements.  <br /></td></tr>
<tr class="separator:ga1301c5bcb61d90998c0b1f97f5c82544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabde5883c5796dbf65beb6ad146b60f93"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___selection.html#gabde5883c5796dbf65beb6ad146b60f93">ACAPI_Selection_SetMarquee</a> (<a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *selectionInfo)</td></tr>
<tr class="memdesc:gabde5883c5796dbf65beb6ad146b60f93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the current marquee selection.  <br /></td></tr>
<tr class="separator:gabde5883c5796dbf65beb6ad146b60f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga243e8cce166409a11eba6616045cef57"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___notification.html#ga243e8cce166409a11eba6616045cef57">ACAPI_Notification_CatchSelectionChange</a> (<a class="el" href="group___notification.html#ga4db5336458c0ae5199127b2eb3fd4c4f">APISelectionChangeHandlerProc</a> *handlerProc)</td></tr>
<tr class="memdesc:ga243e8cce166409a11eba6616045cef57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the monitoring of selection changes on/off.  <br /></td></tr>
<tr class="separator:ga243e8cce166409a11eba6616045cef57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions related to selection and marquee, including selecting elements and listing selected elements or elements included in the marquee. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga4db5336458c0ae5199127b2eb3fd4c4f" name="ga4db5336458c0ae5199127b2eb3fd4c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4db5336458c0ae5199127b2eb3fd4c4f">&#9670;&#160;</a></span>APISelectionChangeHandlerProc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef GSErrCode __ACENV_CALL APISelectionChangeHandlerProc(const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User supplied callback procedure for handling selection changes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selElemNeig</td><td>[in] This structure identifies the last selected element. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This is the function which will be called when your add-on installed it with <a class="el" href="group___notification.html#ga243e8cce166409a11eba6616045cef57">ACAPI_Notification_CatchSelectionChange</a>. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga494cdce1c162a3399f2dbdd6b68e69d3" name="ga494cdce1c162a3399f2dbdd6b68e69d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga494cdce1c162a3399f2dbdd6b68e69d3">&#9670;&#160;</a></span>API_SelRelativePosID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___selection.html#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of the relative position to marquee criteria. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This enum is used when you get information about the current marquee based selection. See the <a class="el" href="group___selection.html#ga1301c5bcb61d90998c0b1f97f5c82544">ACAPI_Selection_Get</a> function. </dd></dl>

</div>
</div>
<a id="ga36f2171ea09f32547154874c2def2c2c" name="ga36f2171ea09f32547154874c2def2c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36f2171ea09f32547154874c2def2c2c">&#9670;&#160;</a></span>API_SelTypeID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___selection.html#ga36f2171ea09f32547154874c2def2c2c">API_SelTypeID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of the selection. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This enum is used when you get information about the current selection. See the <a class="el" href="group___selection.html#ga1301c5bcb61d90998c0b1f97f5c82544">ACAPI_Selection_Get</a> function. There are two basic type of selection methods in Archicad:<ul>
<li>The selection may be controlled by individually selected elements.</li>
<li>The other possibility is to rely on the marquee area. The <code>API_SelEmpty</code> identifier means that no selection is actually used in Archicad. The <code>API_SelElems</code> identifier corresponds to the first method when elements are individually selected. Other values identify that the selection is done by some kind of marquee shape. </li>
</ul>
</dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga243e8cce166409a11eba6616045cef57" name="ga243e8cce166409a11eba6616045cef57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga243e8cce166409a11eba6616045cef57">&#9670;&#160;</a></span>ACAPI_Notification_CatchSelectionChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Notification_CatchSelectionChange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___notification.html#ga4db5336458c0ae5199127b2eb3fd4c4f">APISelectionChangeHandlerProc</a> *&#160;</td>
          <td class="paramname"><em>handlerProc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the monitoring of selection changes on/off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handlerProc</td><td>[in] The callback procedure to call when notifications are sent out on changes in the selection. Specifying nullptr here means you don't need the notifications any more. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function completed successfully. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to register/unregister an add-on which wants to monitor the changes in selection. You do not have to call <a class="el" href="group___add_on_lifetime.html#ga5d158f85a2e2940dd689c4cd1c622199">ACAPI_KeepInMemory</a> afterwards, as the API ensures that add-ons with installed notification handlers won't be unloaded. After registration your add-on's handlerProc you will be called when the selection changes. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Selection change handler function</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> GSErrCode __ACENV_CALL    SelectionChangeHandler (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span>    msgStr[256];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a948fc2dc775cecee4fe3284928af4970">neigID</a> != APINeig_None) {</div>
<div class="line">        sprintf (msgStr, <span class="stringliteral">&quot;Last selected element: NeigID %d; index: %d, inIndex: %d&quot;</span>,</div>
<div class="line">                 selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a948fc2dc775cecee4fe3284928af4970">neigID</a>, selElemNeig-&gt;index, selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a77db1fc87eee825c977e7ca05a76cf0a">inIndex</a>);</div>
<div class="line">        <a class="code hl_function" href="group___dialog.html#ga81bfb6abb734d503d09c3b51dc5fac1a">ACAPI_WriteReport</a> (msgStr, <span class="keyword">false</span>);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_function" href="group___dialog.html#ga81bfb6abb734d503d09c3b51dc5fac1a">ACAPI_WriteReport</a> (<span class="stringliteral">&quot;All elements deselected&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NoError;</div>
<div class="line">}   <span class="comment">// SelectionChangeHandler</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Called after the Add-On has been loaded into memory</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line">GSErrCode    __ACENV_CALL    <a class="code hl_function" href="group___add_on_lifetime.html#ga585642df3fff4d7ef06576cd3efeea13">Initialize</a> (<span class="keywordtype">void</span>)</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    <span class="comment">// catch changes in the selection</span></div>
<div class="line">    GSErrCode err = <a class="code hl_function" href="group___notification.html#ga243e8cce166409a11eba6616045cef57">ACAPI_Notification_CatchSelectionChange</a> (SelectionChangeHandler);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}   <span class="comment">// Initialize</span></div>
<div class="ttc" id="agroup___add_on_lifetime_html_ga585642df3fff4d7ef06576cd3efeea13"><div class="ttname"><a href="group___add_on_lifetime.html#ga585642df3fff4d7ef06576cd3efeea13">Initialize</a></div><div class="ttdeci">GSErrCode __ACDLL_CALL Initialize(void)</div><div class="ttdoc">The main entry point of the add-on.</div></div>
<div class="ttc" id="agroup___dialog_html_ga81bfb6abb734d503d09c3b51dc5fac1a"><div class="ttname"><a href="group___dialog.html#ga81bfb6abb734d503d09c3b51dc5fac1a">ACAPI_WriteReport</a></div><div class="ttdeci">void __ACENV_CALL ACAPI_WriteReport(const GS::UniString &amp;format, bool withDial,...)</div><div class="ttdoc">Writes a report string into the Report Windowot into a custom alert window.</div></div>
<div class="ttc" id="agroup___notification_html_ga243e8cce166409a11eba6616045cef57"><div class="ttname"><a href="group___notification.html#ga243e8cce166409a11eba6616045cef57">ACAPI_Notification_CatchSelectionChange</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Notification_CatchSelectionChange(APISelectionChangeHandlerProc *handlerProc)</div><div class="ttdoc">Turns the monitoring of selection changes on/off.</div></div>
<div class="ttc" id="astruct_a_p_i___neig_html"><div class="ttname"><a href="struct_a_p_i___neig.html">API_Neig</a></div><div class="ttdoc">Describes a neig point of an element.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18836</div></div>
<div class="ttc" id="astruct_a_p_i___neig_html_a77db1fc87eee825c977e7ca05a76cf0a"><div class="ttname"><a href="struct_a_p_i___neig.html#a77db1fc87eee825c977e7ca05a76cf0a">API_Neig::inIndex</a></div><div class="ttdeci">Int32 inIndex</div><div class="ttdoc">Subindex inside the element.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18852</div></div>
<div class="ttc" id="astruct_a_p_i___neig_html_a948fc2dc775cecee4fe3284928af4970"><div class="ttname"><a href="struct_a_p_i___neig.html#a948fc2dc775cecee4fe3284928af4970">API_Neig::neigID</a></div><div class="ttdeci">API_NeigID neigID</div><div class="ttdoc">Type of the element neig. It also defines the type of the element; you can convert the neigID to API_...</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18841</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga4a9cd38f6f56812f12bdde57cfc01f91" name="ga4a9cd38f6f56812f12bdde57cfc01f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a9cd38f6f56812f12bdde57cfc01f91">&#9670;&#160;</a></span>ACAPI_Selection_DeselectAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_DeselectAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds/removes a number of elements to/from the current selection. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADDATABASE - The current database is not proper for the operation. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function acts as "Deselect All". Use <a class="el" href="group___selection.html#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">ACAPI_Selection_Select</a> function to add/remove elements to/from the current selection. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode    Do_SelectAllWalls (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="group___selection.html#ga4a9cd38f6f56812f12bdde57cfc01f91">ACAPI_Selection_DeselectAll</a> ();</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Guid&gt; wallGuids;</div>
<div class="line">    <a class="code hl_function" href="group___element.html#gad0a3cc26ebbcb18613c2d3df01eb7384">ACAPI_Element_GetElemList</a> (API_WallID, &amp;wallGuids);</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Neig&gt; selNeigs;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___guid.html">API_Guid</a>&amp; guid : wallGuids) {</div>
<div class="line">        <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> neig (guid);</div>
<div class="line">        selNeigs.Push (neig);</div>
<div class="line">        <span class="comment">// Note: the following 1 commented line is equivalent to the previous 2 lines</span></div>
<div class="line">        <span class="comment">// selNeigs.PushNew (guid);</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="group___selection.html#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">ACAPI_Selection_Select</a> (selNeigs, <span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___element_html_gad0a3cc26ebbcb18613c2d3df01eb7384"><div class="ttname"><a href="group___element.html#gad0a3cc26ebbcb18613c2d3df01eb7384">ACAPI_Element_GetElemList</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Element_GetElemList(const API_ElemType &amp;type, GS::Array&lt; API_Guid &gt; *elemList, API_ElemFilterFlags filterBits=APIFilt_None, const API_Guid &amp;renovationFilterGuid=APINULLGuid)</div><div class="ttdoc">Returns an array of guids of the elements of the given type.</div></div>
<div class="ttc" id="agroup___selection_html_ga4a9cd38f6f56812f12bdde57cfc01f91"><div class="ttname"><a href="group___selection.html#ga4a9cd38f6f56812f12bdde57cfc01f91">ACAPI_Selection_DeselectAll</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Selection_DeselectAll()</div><div class="ttdoc">Adds/removes a number of elements to/from the current selection.</div></div>
<div class="ttc" id="agroup___selection_html_ga8654f0b2ebed30b60e3fc1f8cf9d8bb1"><div class="ttname"><a href="group___selection.html#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">ACAPI_Selection_Select</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Selection_Select(const GS::Array&lt; API_Neig &gt; &amp;selNeigs, bool add)</div><div class="ttdoc">Adds/removes a number of elements to/from the current selection.</div></div>
<div class="ttc" id="astruct_a_p_i___guid_html"><div class="ttname"><a href="struct_a_p_i___guid.html">API_Guid</a></div><div class="ttdoc">Represents a GS::Guid in the API layer.</div><div class="ttdef"><b>Definition:</b> API_Guid.hpp:45</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga1301c5bcb61d90998c0b1f97f5c82544" name="ga1301c5bcb61d90998c0b1f97f5c82544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1301c5bcb61d90998c0b1f97f5c82544">&#9670;&#160;</a></span>ACAPI_Selection_Get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *&#160;</td>
          <td class="paramname"><em>selectionInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; *&#160;</td>
          <td class="paramname"><em>selNeigs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyEditable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ignorePartialSelection</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___selection.html#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a>&#160;</td>
          <td class="paramname"><em>relativePosToMarquee</em> = <code>API_InsidePartially</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns information on the selection, and the selected elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selectionInfo</td><td>[out] The parameters of the current selection. The typeID field of the selectionInfo gives the selection type. </td></tr>
    <tr><td class="paramname">selNeigs</td><td>[out] An array containing the GUIDs of the selected elements. Can be nullptr if you are interested in the selection information only. </td></tr>
    <tr><td class="paramname">onlyEditable</td><td>[in] Tells whether you are interested in editable elements only. </td></tr>
    <tr><td class="paramname">ignorePartialSelection</td><td>[in] Retrieves also partial element selection information or the element itself only selected as whole (for legacy compatibility reasons, the default value of this parameter is true, meaning partial selection is ignored). This parameter is ignored in case of marquee based selection. </td></tr>
    <tr><td class="paramname">relativePosToMarquee</td><td>[in] Retrieves elements relative to marquee (for legacy compatibility reasons, the default value of this parameter is <code>API_InsidePartially</code>, meaning only those elements will be returned which have an intersection with the marquee area). This parameter is ignored in case of individually selected elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_NOPLAN - There is no open project.</li>
<li>APIERR_NOSEL - There is no selection. Note that this is not a real error! </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to get information about the current selection and to retrieve the selected elements. The information is returned in the selectionInfo parameter. If individual elements are selected the <code>API_SelElems</code> identifier is returned. The number of the selected and selected and editable elements are also returned. In case of marquee based selection, the function gives back the actual polygon of the current selection in the <a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> structure; don't forget to dispose this handle. The <code>API_SelEmpty</code> identifier in the typeID field of the selectionInfo parameter means that no selection is actually used in Archicad. In case of individually selected elements, Archicad returns all the elements which are selected. In the case of marquee based selection, only those will be returned which match the position criteria defined by relativePosToMarquee. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Collect in inds the guids of the dimensions to work with</span></div>
<div class="line"><span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> GSErrCode SelectDimensions (GS::Array&lt;API_Guid&gt;&amp; inds)</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    GSErrCode            err;</div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a>    selectionInfo;</div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___elem___head.html">API_Elem_Head</a>        tElemHead;</div>
<div class="line">    GS::Array&lt;API_Neig&gt;  selNeigs;</div>
<div class="line"> </div>
<div class="line">    err = <a class="code hl_function" href="group___selection.html#ga1301c5bcb61d90998c0b1f97f5c82544">ACAPI_Selection_Get</a> (&amp;selectionInfo, &amp;selNeigs, <span class="keyword">true</span>);</div>
<div class="line">    BMKillHandle ((GSHandle *) &amp;selectionInfo.<a class="code hl_variable" href="struct_a_p_i___selection_info.html#a09dbc6e8322fa420235e63e0480ffbaf">marquee</a>.<a class="code hl_variable" href="struct_a_p_i___region.html#a4d780db406fa492aab751033f9bdbde7">coords</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (err == APIERR_NOSEL)</div>
<div class="line">        err = NoError;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (selectionInfo.<a class="code hl_variable" href="struct_a_p_i___selection_info.html#a54226ad3f16d2eca6e3387743d870efd">typeID</a> != API_SelEmpty) {</div>
<div class="line">        <span class="comment">// collect indexes of selected dimensions</span></div>
<div class="line">        UInt32 nSel = BMGetHandleSize ((GSHandle) selNeigs) / <span class="keyword">sizeof</span> (<a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a>&amp; selNeig : selNeigs) {</div>
<div class="line">            tElemHead.typeID = Neig_To_ElemID (selNeig.neigID);</div>
<div class="line">            <span class="keywordflow">if</span> (tElemHead.typeID != API_DimensionID)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code hl_function" href="group___element.html#gaea779ec9850044f0fd169752b58e50f2">ACAPI_Element_Filter</a> (selNeig.guid, APIFilt_IsEditable))</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#aa3cef1d08910014c1546b66c0bf9c05a">guid</a> = selNeig.guid;</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_function" href="group___element.html#ga05898a9202337063738e6ec61e7376ca">ACAPI_Element_GetHeader</a> (&amp;tElemHead) != NoError)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Add dimension to the array</span></div>
<div class="line">            inds.Push (tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#aa3cef1d08910014c1546b66c0bf9c05a">guid</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}   <span class="comment">// SelectDimensions</span></div>
<div class="ttc" id="agroup___element_html_ga05898a9202337063738e6ec61e7376ca"><div class="ttname"><a href="group___element.html#ga05898a9202337063738e6ec61e7376ca">ACAPI_Element_GetHeader</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Element_GetHeader(API_Elem_Head *elementHead, UInt32 mask=0)</div><div class="ttdoc">Returns general information on the given element.</div></div>
<div class="ttc" id="agroup___element_html_gaea779ec9850044f0fd169752b58e50f2"><div class="ttname"><a href="group___element.html#gaea779ec9850044f0fd169752b58e50f2">ACAPI_Element_Filter</a></div><div class="ttdeci">bool __ACENV_CALL ACAPI_Element_Filter(const API_Guid &amp;guid, API_ElemFilterFlags filterBits, API_ElemVariationID variationID=APIVarId_Generic, const API_Guid &amp;renovationFilterGuid=APINULLGuid)</div><div class="ttdoc">Tests an element by some given criteria.</div></div>
<div class="ttc" id="agroup___selection_html_ga1301c5bcb61d90998c0b1f97f5c82544"><div class="ttname"><a href="group___selection.html#ga1301c5bcb61d90998c0b1f97f5c82544">ACAPI_Selection_Get</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_Selection_Get(API_SelectionInfo *selectionInfo, GS::Array&lt; API_Neig &gt; *selNeigs, bool onlyEditable, bool ignorePartialSelection=true, API_SelRelativePosID relativePosToMarquee=API_InsidePartially)</div><div class="ttdoc">Returns information on the selection, and the selected elements.</div></div>
<div class="ttc" id="astruct_a_p_i___elem___head_html"><div class="ttname"><a href="struct_a_p_i___elem___head.html">API_Elem_Head</a></div><div class="ttdoc">General element header for element types.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:362</div></div>
<div class="ttc" id="astruct_a_p_i___elem___head_html_aa3cef1d08910014c1546b66c0bf9c05a"><div class="ttname"><a href="struct_a_p_i___elem___head.html#aa3cef1d08910014c1546b66c0bf9c05a">API_Elem_Head::guid</a></div><div class="ttdeci">API_Guid guid</div><div class="ttdoc">The globally unique identifier of the element. It is type-independent, and guaranteed to be globally ...</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:375</div></div>
<div class="ttc" id="astruct_a_p_i___region_html_a4d780db406fa492aab751033f9bdbde7"><div class="ttname"><a href="struct_a_p_i___region.html#a4d780db406fa492aab751033f9bdbde7">API_Region::coords</a></div><div class="ttdeci">API_Coord ** coords</div><div class="ttdoc">the coordinate handle (in case of polygonal representation)</div><div class="ttdef"><b>Definition:</b> APIdefs_Base.h:292</div></div>
<div class="ttc" id="astruct_a_p_i___selection_info_html"><div class="ttname"><a href="struct_a_p_i___selection_info.html">API_SelectionInfo</a></div><div class="ttdoc">Information about the current selection.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18516</div></div>
<div class="ttc" id="astruct_a_p_i___selection_info_html_a09dbc6e8322fa420235e63e0480ffbaf"><div class="ttname"><a href="struct_a_p_i___selection_info.html#a09dbc6e8322fa420235e63e0480ffbaf">API_SelectionInfo::marquee</a></div><div class="ttdeci">API_Region marquee</div><div class="ttdoc">The parameters of the marquee selection region.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18547</div></div>
<div class="ttc" id="astruct_a_p_i___selection_info_html_a54226ad3f16d2eca6e3387743d870efd"><div class="ttname"><a href="struct_a_p_i___selection_info.html#a54226ad3f16d2eca6e3387743d870efd">API_SelectionInfo::typeID</a></div><div class="ttdeci">API_SelTypeID typeID</div><div class="ttdoc">The type of the selection. It can be one of the marquee type or element type selection.</div><div class="ttdef"><b>Definition:</b> APIdefs_Elements.h:18521</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga9bf76846795b363e9a419a5e9fd3c874" name="ga9bf76846795b363e9a419a5e9fd3c874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9bf76846795b363e9a419a5e9fd3c874">&#9670;&#160;</a></span>ACAPI_Selection_GetSelectedElement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_GetSelectedElement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *&#160;</td>
          <td class="paramname"><em>apiNeig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *&#160;</td>
          <td class="paramname"><em>apiGuid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> structure to an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apiNeig</td><td>[in] The Neig describing a point of the Element. </td></tr>
    <tr><td class="paramname">apiGuid</td><td>[out] The GUID of the Subelement at that point. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - apiGuid or apiNeig is nullptr. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga8654f0b2ebed30b60e3fc1f8cf9d8bb1" name="ga8654f0b2ebed30b60e3fc1f8cf9d8bb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">&#9670;&#160;</a></span>ACAPI_Selection_Select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_Select </td>
          <td>(</td>
          <td class="paramtype">const GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>selNeigs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds/removes a number of elements to/from the current selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selNeigs</td><td>[in] The elements to be added/removed (array of <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> objects); </td></tr>
    <tr><td class="paramname">add</td><td>[in] If true, adds the elements to the current selection, otherwise removes them from the selection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADDATABASE - The current database is not proper for the operation.</li>
<li>APIERR_BADID - The element unique ID is invalid. The element type is invalid, or the element type is not supported by the server application.</li>
<li>APIERR_BADPARS - The passed parameter contains invalid data; selNeigs. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>You can use this function to add/remove (add flag) a number of (nItem) elements to/from the current selection. The elements are defined by the selNeigs array of type <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. Use <a class="el" href="group___selection.html#ga4a9cd38f6f56812f12bdde57cfc01f91">ACAPI_Selection_DeselectAll</a> function to remove all elements from the selection. The neigID and the guid fields are required (inIndex and/or holeSel only where applicable). The <a class="el" href="group___element.html#ga58ee0e482d4747dc7bf3302cd7551272">API_NeigID</a> is differs from the <a class="el" href="group___element.html#ga2502601bf26ffc7abc608f6988da4d91">API_ElemTypeID</a>, because it refers to the selectable parts of the elements, not the elements themselves. You can select not only whole elements but element parts, such as vertices, edges and faces, specified in the <code>elemPartType</code> and <code>elemPartIndex</code> fields of <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keyword">static</span> GSErrCode    Do_SelectAllWalls (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="group___selection.html#ga4a9cd38f6f56812f12bdde57cfc01f91">ACAPI_Selection_DeselectAll</a> ();</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Guid&gt; wallGuids;</div>
<div class="line">    <a class="code hl_function" href="group___element.html#gad0a3cc26ebbcb18613c2d3df01eb7384">ACAPI_Element_GetElemList</a> (API_WallID, &amp;wallGuids);</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Neig&gt; selNeigs;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___guid.html">API_Guid</a>&amp; guid : wallGuids) {</div>
<div class="line">        <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> neig (guid);</div>
<div class="line">        selNeigs.Push (neig);</div>
<div class="line">        <span class="comment">// Note: the following 1 commented line is equivalent to the previous 2 lines</span></div>
<div class="line">        <span class="comment">// selNeigs.PushNew (guid);</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="group___selection.html#ga8654f0b2ebed30b60e3fc1f8cf9d8bb1">ACAPI_Selection_Select</a> (selNeigs, <span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="gabde5883c5796dbf65beb6ad146b60f93" name="gabde5883c5796dbf65beb6ad146b60f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabde5883c5796dbf65beb6ad146b60f93">&#9670;&#160;</a></span>ACAPI_Selection_SetMarquee()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_SetMarquee </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *&#160;</td>
          <td class="paramname"><em>selectionInfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes the current marquee selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selectionInfo</td><td>[in] The parameters of the marquee to be set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - The selectionInfo parameter is nullptr</li>
<li>APIERR_BADDATABASE - The active database is neither the floorplan, nor a section database </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to change the marquee on a floorplan or section window. The typeID field of the selectionInfo must be <code>API_MarqueePoly</code>, <code>API_MarqueeHorBox</code> or <code>API_MarqueeRotBox</code> in order to set a new marquee outline, otherwise the actual marquee will be removed. The function has no effect on the individual selection of elements. In case of <code>API_MarqueePoly</code> type marquee do not forget to release the coordinate handle passed in the selectionInfo parameter. </dd></dl>

</div>
</div>
<a id="ga10730d6017d3c9d5586e97327b211f24" name="ga10730d6017d3c9d5586e97327b211f24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga10730d6017d3c9d5586e97327b211f24">&#9670;&#160;</a></span>ACAPI_Selection_SetSelectedElementNeig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_Selection_SetSelectedElementNeig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *&#160;</td>
          <td class="paramname"><em>apiGuid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *&#160;</td>
          <td class="paramname"><em>apiNeig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> structure to an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apiGuid</td><td>[in] The GUID of the Subelement at that point. </td></tr>
    <tr><td class="paramname">apiNeig</td><td>[out] The Neig describing a point of the Element. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - apiGuid or apiNeig is nullptr. </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>