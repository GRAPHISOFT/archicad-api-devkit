<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad 29 C++ API: Selection handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="logo.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad 29 C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___selection.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Selection handling</div></div>
</div><!--header-->
<div class="contents">

<p>Functions related to selection and marquee, including selecting elements and listing selected elements or elements included in the marquee.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about the current selection.  <a href="struct_a_p_i___selection_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___marquee_filter.html">API_MarqueeFilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the filter for 3D filter and cut settings.  <a href="struct_a_p_i___marquee_filter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga36fda8d571836dc69959886ed2ad9fcc" id="r_ga36fda8d571836dc69959886ed2ad9fcc"><td class="memItemLeft" align="right" valign="top">typedef GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___notification.html#ga36fda8d571836dc69959886ed2ad9fcc">APISelectionChangeHandlerProc</a>(const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</td></tr>
<tr class="memdesc:ga36fda8d571836dc69959886ed2ad9fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">User supplied callback procedure for handling selection changes.  <br /></td></tr>
<tr class="separator:ga36fda8d571836dc69959886ed2ad9fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga36f2171ea09f32547154874c2def2c2c" id="r_ga36f2171ea09f32547154874c2def2c2c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga36f2171ea09f32547154874c2def2c2c">API_SelTypeID</a> { <br />
&#160;&#160;<a class="el" href="#gga36f2171ea09f32547154874c2def2c2cac4dc54aa1b18a9dacd41a835214f5e90">API_SelEmpty</a> = 0
, <a class="el" href="#gga36f2171ea09f32547154874c2def2c2ca115564bddfa3e591f524f64cf53071a0">API_SelElems</a>
, <a class="el" href="#gga36f2171ea09f32547154874c2def2c2caf0d24f291630c3aa574663285f4c44dc">API_MarqueePoly</a>
, <a class="el" href="#gga36f2171ea09f32547154874c2def2c2cad480178c78a0e124ce94f5e4d767e477">API_MarqueeHorBox</a>
, <br />
&#160;&#160;<a class="el" href="#gga36f2171ea09f32547154874c2def2c2ca6101a575b6170cae9164bac1c847b1e7">API_MarqueeRotBox</a>
<br />
 }</td></tr>
<tr class="memdesc:ga36f2171ea09f32547154874c2def2c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of the selection.  <a href="#ga36f2171ea09f32547154874c2def2c2c">More...</a><br /></td></tr>
<tr class="separator:ga36f2171ea09f32547154874c2def2c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga494cdce1c162a3399f2dbdd6b68e69d3" id="r_ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a> { <a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3abf71438fddafa2970ec1964000e3c418">API_InsidePartially</a> = 0
, <a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3a95249bcda68675850157c2d4b19e8312">API_InsideEntirely</a>
, <a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3a4a83591d47c386b782184b63a07bf29f">API_OutsidePartially</a>
, <a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3ab1aeff17a6db04e72cc308d11300bd89">API_OutsideEntirely</a>
 }</td></tr>
<tr class="memdesc:ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of the relative position to marquee criteria.  <a href="#ga494cdce1c162a3399f2dbdd6b68e69d3">More...</a><br /></td></tr>
<tr class="separator:ga494cdce1c162a3399f2dbdd6b68e69d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d1b1bb4ae441d246b019d765e219fa2" id="r_ga1d1b1bb4ae441d246b019d765e219fa2"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1d1b1bb4ae441d246b019d765e219fa2">ACAPI_Selection_GetSelectedElement</a> (const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *apiNeig, <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *apiGuid)</td></tr>
<tr class="memdesc:ga1d1b1bb4ae441d246b019d765e219fa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> structure to an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a>.  <br /></td></tr>
<tr class="separator:ga1d1b1bb4ae441d246b019d765e219fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83adc25d6276582c63d3662e251231d0" id="r_ga83adc25d6276582c63d3662e251231d0"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga83adc25d6276582c63d3662e251231d0">ACAPI_Selection_SetSelectedElementNeig</a> (const <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *apiGuid, <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *apiNeig)</td></tr>
<tr class="memdesc:ga83adc25d6276582c63d3662e251231d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> structure to an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>.  <br /></td></tr>
<tr class="separator:ga83adc25d6276582c63d3662e251231d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2d070e49c004d61909e239828b3b8f7" id="r_gaf2d070e49c004d61909e239828b3b8f7"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf2d070e49c004d61909e239828b3b8f7">ACAPI_Selection_Select</a> (const GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; &amp;selNeigs, bool add)</td></tr>
<tr class="memdesc:gaf2d070e49c004d61909e239828b3b8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds/removes a number of elements to/from the current selection.  <br /></td></tr>
<tr class="separator:gaf2d070e49c004d61909e239828b3b8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6119d4d286e53921d7714bdcbcaec888" id="r_ga6119d4d286e53921d7714bdcbcaec888"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6119d4d286e53921d7714bdcbcaec888">ACAPI_Selection_DeselectAll</a> ()</td></tr>
<tr class="memdesc:ga6119d4d286e53921d7714bdcbcaec888"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds/removes a number of elements to/from the current selection.  <br /></td></tr>
<tr class="separator:ga6119d4d286e53921d7714bdcbcaec888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ce5d8d061124d9e10bc9d51a7939d90" id="r_ga0ce5d8d061124d9e10bc9d51a7939d90"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0ce5d8d061124d9e10bc9d51a7939d90">ACAPI_Selection_Get</a> (<a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *selectionInfo, GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; *selNeigs, bool onlyEditable, bool ignorePartialSelection=true, <a class="el" href="#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a> relativePosToMarquee=<a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3abf71438fddafa2970ec1964000e3c418">API_InsidePartially</a>)</td></tr>
<tr class="memdesc:ga0ce5d8d061124d9e10bc9d51a7939d90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns information on the selection, and the selected elements.  <br /></td></tr>
<tr class="separator:ga0ce5d8d061124d9e10bc9d51a7939d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga269f9b4b369bb950a85bdd10e5594db2" id="r_ga269f9b4b369bb950a85bdd10e5594db2"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga269f9b4b369bb950a85bdd10e5594db2">ACAPI_Selection_SetMarquee</a> (<a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *selectionInfo)</td></tr>
<tr class="memdesc:ga269f9b4b369bb950a85bdd10e5594db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the current marquee selection.  <br /></td></tr>
<tr class="separator:ga269f9b4b369bb950a85bdd10e5594db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ddf5bbdeab36559c94c6cf01404f0e8" id="r_ga5ddf5bbdeab36559c94c6cf01404f0e8"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___notification.html#ga5ddf5bbdeab36559c94c6cf01404f0e8">ACAPI_Notification_CatchSelectionChange</a> (<a class="el" href="group___notification.html#ga36fda8d571836dc69959886ed2ad9fcc">APISelectionChangeHandlerProc</a> *handlerProc)</td></tr>
<tr class="memdesc:ga5ddf5bbdeab36559c94c6cf01404f0e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the monitoring of selection changes on/off.  <br /></td></tr>
<tr class="separator:ga5ddf5bbdeab36559c94c6cf01404f0e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions related to selection and marquee, including selecting elements and listing selected elements or elements included in the marquee. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga36fda8d571836dc69959886ed2ad9fcc" name="ga36fda8d571836dc69959886ed2ad9fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36fda8d571836dc69959886ed2ad9fcc">&#9670;&#160;</a></span>APISelectionChangeHandlerProc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef GSErrCode APISelectionChangeHandlerProc(const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User supplied callback procedure for handling selection changes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selElemNeig</td><td>[in] This structure identifies the last selected element. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This is the function which will be called when your add-on installed it with <a class="el" href="group___notification.html#ga5ddf5bbdeab36559c94c6cf01404f0e8">ACAPI_Notification_CatchSelectionChange</a>. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga494cdce1c162a3399f2dbdd6b68e69d3" name="ga494cdce1c162a3399f2dbdd6b68e69d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga494cdce1c162a3399f2dbdd6b68e69d3">&#9670;&#160;</a></span>API_SelRelativePosID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of the relative position to marquee criteria. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This enum is used when you get information about the current marquee based selection. See the <a class="el" href="#ga0ce5d8d061124d9e10bc9d51a7939d90">ACAPI_Selection_Get</a> function. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga494cdce1c162a3399f2dbdd6b68e69d3abf71438fddafa2970ec1964000e3c418" name="gga494cdce1c162a3399f2dbdd6b68e69d3abf71438fddafa2970ec1964000e3c418"></a>API_InsidePartially&#160;</td><td class="fielddoc"><p>Inside partially. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga494cdce1c162a3399f2dbdd6b68e69d3a95249bcda68675850157c2d4b19e8312" name="gga494cdce1c162a3399f2dbdd6b68e69d3a95249bcda68675850157c2d4b19e8312"></a>API_InsideEntirely&#160;</td><td class="fielddoc"><p>Inside Entirely </p>
</td></tr>
<tr><td class="fieldname"><a id="gga494cdce1c162a3399f2dbdd6b68e69d3a4a83591d47c386b782184b63a07bf29f" name="gga494cdce1c162a3399f2dbdd6b68e69d3a4a83591d47c386b782184b63a07bf29f"></a>API_OutsidePartially&#160;</td><td class="fielddoc"><p>Outside Partially </p>
</td></tr>
<tr><td class="fieldname"><a id="gga494cdce1c162a3399f2dbdd6b68e69d3ab1aeff17a6db04e72cc308d11300bd89" name="gga494cdce1c162a3399f2dbdd6b68e69d3ab1aeff17a6db04e72cc308d11300bd89"></a>API_OutsideEntirely&#160;</td><td class="fielddoc"><p>Outside Entirely </p>
</td></tr>
</table>

</div>
</div>
<a id="ga36f2171ea09f32547154874c2def2c2c" name="ga36f2171ea09f32547154874c2def2c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36f2171ea09f32547154874c2def2c2c">&#9670;&#160;</a></span>API_SelTypeID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga36f2171ea09f32547154874c2def2c2c">API_SelTypeID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of the selection. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This enum is used when you get information about the current selection. See the <a class="el" href="#ga0ce5d8d061124d9e10bc9d51a7939d90">ACAPI_Selection_Get</a> function. There are two basic type of selection methods in Archicad:<ul>
<li>The selection may be controlled by individually selected elements.</li>
<li>The other possibility is to rely on the marquee area. The <code>API_SelEmpty</code> identifier means that no selection is actually used in Archicad. The <code>API_SelElems</code> identifier corresponds to the first method when elements are individually selected. Other values identify that the selection is done by some kind of marquee shape. </li>
</ul>
</dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga36f2171ea09f32547154874c2def2c2cac4dc54aa1b18a9dacd41a835214f5e90" name="gga36f2171ea09f32547154874c2def2c2cac4dc54aa1b18a9dacd41a835214f5e90"></a>API_SelEmpty&#160;</td><td class="fielddoc"><p>Nothing is selected </p>
</td></tr>
<tr><td class="fieldname"><a id="gga36f2171ea09f32547154874c2def2c2ca115564bddfa3e591f524f64cf53071a0" name="gga36f2171ea09f32547154874c2def2c2ca115564bddfa3e591f524f64cf53071a0"></a>API_SelElems&#160;</td><td class="fielddoc"><p>Individual elements are selected </p>
</td></tr>
<tr><td class="fieldname"><a id="gga36f2171ea09f32547154874c2def2c2caf0d24f291630c3aa574663285f4c44dc" name="gga36f2171ea09f32547154874c2def2c2caf0d24f291630c3aa574663285f4c44dc"></a>API_MarqueePoly&#160;</td><td class="fielddoc"><p>Selection is based on marquee poly </p>
</td></tr>
<tr><td class="fieldname"><a id="gga36f2171ea09f32547154874c2def2c2cad480178c78a0e124ce94f5e4d767e477" name="gga36f2171ea09f32547154874c2def2c2cad480178c78a0e124ce94f5e4d767e477"></a>API_MarqueeHorBox&#160;</td><td class="fielddoc"><p>Selection is based on marquee horizontal box </p>
</td></tr>
<tr><td class="fieldname"><a id="gga36f2171ea09f32547154874c2def2c2ca6101a575b6170cae9164bac1c847b1e7" name="gga36f2171ea09f32547154874c2def2c2ca6101a575b6170cae9164bac1c847b1e7"></a>API_MarqueeRotBox&#160;</td><td class="fielddoc"><p>Selection is based on marquee rotated box </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5ddf5bbdeab36559c94c6cf01404f0e8" name="ga5ddf5bbdeab36559c94c6cf01404f0e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ddf5bbdeab36559c94c6cf01404f0e8">&#9670;&#160;</a></span>ACAPI_Notification_CatchSelectionChange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Notification_CatchSelectionChange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___notification.html#ga36fda8d571836dc69959886ed2ad9fcc">APISelectionChangeHandlerProc</a> *</td>          <td class="paramname"><span class="paramname"><em>handlerProc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the monitoring of selection changes on/off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handlerProc</td><td>[in] The callback procedure to call when notifications are sent out on changes in the selection. Specifying nullptr here means you don't need the notifications any more. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function completed successfully. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to register/unregister an add-on which wants to monitor the changes in selection. You do not have to call <a class="el" href="group___add_on_lifetime.html#ga94e03de5747d369df034c790ea8c2513">ACAPI_KeepInMemory</a> afterwards, as the API ensures that add-ons with installed notification handlers won't be unloaded. After registration your add-on's handlerProc you will be called when the selection changes. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Selection change handler function</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="keyword">static</span> GSErrCode SelectionChangeHandler (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> *selElemNeig)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> msgStr[256];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a1a9ac7712106d86eb39c1888fc39e94f">neigID</a> != APINeig_None) {</div>
<div class="line">        sprintf (msgStr, <span class="stringliteral">&quot;Last selected element: NeigID %d; index: %d, inIndex: %d&quot;</span>,</div>
<div class="line">                 selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a1a9ac7712106d86eb39c1888fc39e94f">neigID</a>, <span class="keyword">static_cast&lt;</span>Int32<span class="keyword">&gt;</span> (selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a5593bc949924ff48d715b07c8e76145d">elemPartIndex</a>), selElemNeig-&gt;<a class="code hl_variable" href="struct_a_p_i___neig.html#a3be2b592ab2146b068e0a8bffa3e5096">inIndex</a>);</div>
<div class="line">        <a class="code hl_function" href="group___dialog.html#ga75bf1a5faae2194c165ee4fcaf6afa38">ACAPI_WriteReport</a> (msgStr, <span class="keyword">false</span>);</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_function" href="group___dialog.html#ga75bf1a5faae2194c165ee4fcaf6afa38">ACAPI_WriteReport</a> (<span class="stringliteral">&quot;All elements deselected&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NoError;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Called after the Add-On has been loaded into memory</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line">GSErrCode <a class="code hl_function" href="group___add_on_lifetime.html#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> ()</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    <span class="comment">// catch changes in the selection</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="group___notification.html#ga5ddf5bbdeab36559c94c6cf01404f0e8">ACAPI_Notification_CatchSelectionChange</a> (SelectionChangeHandler);</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga6119d4d286e53921d7714bdcbcaec888" name="ga6119d4d286e53921d7714bdcbcaec888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6119d4d286e53921d7714bdcbcaec888">&#9670;&#160;</a></span>ACAPI_Selection_DeselectAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_DeselectAll </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds/removes a number of elements to/from the current selection. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADDATABASE - The current database is not proper for the operation. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function acts as "Deselect All". Use <a class="el" href="#gaf2d070e49c004d61909e239828b3b8f7">ACAPI_Selection_Select</a> function to add/remove elements to/from the current selection. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode Do_SelectAllWalls (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="#ga6119d4d286e53921d7714bdcbcaec888">ACAPI_Selection_DeselectAll</a> ();</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Guid&gt; wallGuids;</div>
<div class="line">    <a class="code hl_function" href="group___element.html#ga1e5c492e5419647568f209003ab0571b">ACAPI_Element_GetElemList</a> (<a class="code hl_enumvalue" href="group___element.html#gga2502601bf26ffc7abc608f6988da4d91a97df09286f89e43fadeb4c6abbc09bc3">API_WallID</a>, &amp;wallGuids);</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Neig&gt; selNeigs;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___guid.html">API_Guid</a>&amp; guid : wallGuids) {</div>
<div class="line">        <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> neig (guid);</div>
<div class="line">        selNeigs.Push (neig);</div>
<div class="line">        <span class="comment">// Note: the following 1 commented line is equivalent to the previous 2 lines</span></div>
<div class="line">        <span class="comment">// selNeigs.PushNew (guid);</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="#gaf2d070e49c004d61909e239828b3b8f7">ACAPI_Selection_Select</a> (selNeigs, <span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga0ce5d8d061124d9e10bc9d51a7939d90" name="ga0ce5d8d061124d9e10bc9d51a7939d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ce5d8d061124d9e10bc9d51a7939d90">&#9670;&#160;</a></span>ACAPI_Selection_Get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>selectionInfo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>selNeigs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>onlyEditable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>ignorePartialSelection</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ga494cdce1c162a3399f2dbdd6b68e69d3">API_SelRelativePosID</a></td>          <td class="paramname"><span class="paramname"><em>relativePosToMarquee</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#gga494cdce1c162a3399f2dbdd6b68e69d3abf71438fddafa2970ec1964000e3c418">API_InsidePartially</a></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns information on the selection, and the selected elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selectionInfo</td><td>[out] The parameters of the current selection. The typeID field of the selectionInfo gives the selection type. </td></tr>
    <tr><td class="paramname">selNeigs</td><td>[out] An array containing the GUIDs of the selected elements. Can be nullptr if you are interested in the selection information only. </td></tr>
    <tr><td class="paramname">onlyEditable</td><td>[in] Tells whether you are interested in editable elements only. </td></tr>
    <tr><td class="paramname">ignorePartialSelection</td><td>[in] Retrieves also partial element selection information or the element itself only selected as whole (for legacy compatibility reasons, the default value of this parameter is true, meaning partial selection is ignored). This parameter is ignored in case of marquee based selection. </td></tr>
    <tr><td class="paramname">relativePosToMarquee</td><td>[in] Retrieves elements relative to marquee (for legacy compatibility reasons, the default value of this parameter is <code>API_InsidePartially</code>, meaning only those elements will be returned which have an intersection with the marquee area). This parameter is ignored in case of individually selected elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_NOPLAN - There is no open project.</li>
<li>APIERR_NOSEL - There is no selection. Note that this is not a real error! </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to get information about the current selection and to retrieve the selected elements. The information is returned in the selectionInfo parameter. If individual elements are selected the <code>API_SelElems</code> identifier is returned. The number of the selected and selected and editable elements are also returned. In case of marquee based selection, the function gives back the actual polygon of the current selection in the <a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> structure; don't forget to dispose this handle. The <code>API_SelEmpty</code> identifier in the typeID field of the selectionInfo parameter means that no selection is actually used in Archicad. In case of individually selected elements, Archicad returns all the elements which are selected. In the case of marquee based selection, only those will be returned which match the position criteria defined by relativePosToMarquee. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Collect in inds the guids of the dimensions to work with</span></div>
<div class="line"><span class="comment">//------------------------------------------------------------</span></div>
<div class="line">GSErrCode SelectDimensions (GS::Array&lt;API_Guid&gt;&amp; inds)</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> selectionInfo;</div>
<div class="line">    GS::Array&lt;API_Neig&gt; selNeigs;</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">const</span> GSErrCode err = <a class="code hl_function" href="#ga0ce5d8d061124d9e10bc9d51a7939d90">ACAPI_Selection_Get</a> (&amp;selectionInfo, &amp;selNeigs, <span class="keyword">true</span>); err != NoError &amp;&amp; err != <a class="code hl_enumvalue" href="group___a_p_i_infrastructure.html#gga75cc225b8e9434d91621dd230c3013a2abccdb2aad6d1cd75984b7a6a8935f824">APIERR_NOSEL</a>) {</div>
<div class="line">        <a class="code hl_function" href="group___dialog.html#ga75bf1a5faae2194c165ee4fcaf6afa38">ACAPI_WriteReport</a> (<span class="stringliteral">&quot;ACAPI_Selection_Get failed with error code: %d&quot;</span>, <span class="keyword">false</span>, &amp;err);</div>
<div class="line">        <span class="keywordflow">return</span> err;</div>
<div class="line">    }</div>
<div class="line">    BMKillHandle ((GSHandle*) &amp;selectionInfo.<a class="code hl_variable" href="struct_a_p_i___selection_info.html#adc0d637323e4c26cf6801d2042cdc0ed">marquee</a>.<a class="code hl_variable" href="struct_a_p_i___region.html#a5dd3c78b0e76f96071deeb9f477021d9">coords</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (selectionInfo.<a class="code hl_variable" href="struct_a_p_i___selection_info.html#a4a09f3b20407f58b137522fd942bebac">typeID</a> == <a class="code hl_enumvalue" href="#gga36f2171ea09f32547154874c2def2c2cac4dc54aa1b18a9dacd41a835214f5e90">API_SelEmpty</a>) {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group___a_p_i_infrastructure.html#gga75cc225b8e9434d91621dd230c3013a2abccdb2aad6d1cd75984b7a6a8935f824">APIERR_NOSEL</a>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// collect guids of selected dimensions</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a>&amp; selNeig : selNeigs) {</div>
<div class="line">        <a class="code hl_struct" href="struct_a_p_i___elem___head.html">API_Elem_Head</a> tElemHead;</div>
<div class="line">        tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#a04205822a00b386df0875148b41835e3">type</a> = Neig_To_ElemID (selNeig.neigID);</div>
<div class="line">        <span class="keywordflow">if</span> (tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#a04205822a00b386df0875148b41835e3">type</a>.<a class="code hl_variable" href="struct_a_p_i___elem_type.html#a7f5c563f02fce9eed861b2c0dc9d7daa">typeID</a> != <a class="code hl_enumvalue" href="group___element.html#gga2502601bf26ffc7abc608f6988da4d91a70b5079fcc6d78580b1f2cc42adb1366">API_DimensionID</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_function" href="group___element.html#gae6b1be3842fc43fc42702c48a93f72e7">ACAPI_Element_Filter</a> (selNeig.guid, APIFilt_IsEditable))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#ae1c055907c06039af552a4e42a9a4e84">guid</a> = selNeig.guid;</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group___element.html#gad9bf3ff2dc33d09cc14aadb898abc381">ACAPI_Element_GetHeader</a> (&amp;tElemHead) != NoError)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Add dimension to the array</span></div>
<div class="line">        inds.Push (tElemHead.<a class="code hl_variable" href="struct_a_p_i___elem___head.html#ae1c055907c06039af552a4e42a9a4e84">guid</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NoError;</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga1d1b1bb4ae441d246b019d765e219fa2" name="ga1d1b1bb4ae441d246b019d765e219fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d1b1bb4ae441d246b019d765e219fa2">&#9670;&#160;</a></span>ACAPI_Selection_GetSelectedElement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_GetSelectedElement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *</td>          <td class="paramname"><span class="paramname"><em>apiNeig</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *</td>          <td class="paramname"><span class="paramname"><em>apiGuid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> structure to an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apiNeig</td><td>[in] The Neig describing a point of the Element. </td></tr>
    <tr><td class="paramname">apiGuid</td><td>[out] The GUID of the Subelement at that point. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - apiGuid or apiNeig is nullptr. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="gaf2d070e49c004d61909e239828b3b8f7" name="gaf2d070e49c004d61909e239828b3b8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2d070e49c004d61909e239828b3b8f7">&#9670;&#160;</a></span>ACAPI_Selection_Select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_Select </td>
          <td>(</td>
          <td class="paramtype">const GS::Array&lt; <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>selNeigs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>add</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds/removes a number of elements to/from the current selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selNeigs</td><td>[in] The elements to be added/removed (array of <a class="el" href="struct_a_p_i___neig.html">API_Neig</a> objects); </td></tr>
    <tr><td class="paramname">add</td><td>[in] If true, adds the elements to the current selection, otherwise removes them from the selection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADDATABASE - The current database is not proper for the operation.</li>
<li>APIERR_BADID - The element unique ID is invalid. The element type is invalid, or the element type is not supported by the server application.</li>
<li>APIERR_BADPARS - The passed parameter contains invalid data; selNeigs. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>You can use this function to add/remove (add flag) a number of (nItem) elements to/from the current selection. The elements are defined by the selNeigs array of type <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. Use <a class="el" href="#ga6119d4d286e53921d7714bdcbcaec888">ACAPI_Selection_DeselectAll</a> function to remove all elements from the selection. The neigID and the guid fields are required (inIndex and/or holeSel only where applicable). The <a class="el" href="group___element.html#ga58ee0e482d4747dc7bf3302cd7551272">API_NeigID</a> is differs from the <a class="el" href="group___element.html#ga2502601bf26ffc7abc608f6988da4d91">API_ElemTypeID</a>, because it refers to the selectable parts of the elements, not the elements themselves. You can select not only whole elements but element parts, such as vertices, edges and faces, specified in the <code>elemPartType</code> and <code>elemPartIndex</code> fields of <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode Do_SelectAllWalls (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="#ga6119d4d286e53921d7714bdcbcaec888">ACAPI_Selection_DeselectAll</a> ();</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Guid&gt; wallGuids;</div>
<div class="line">    <a class="code hl_function" href="group___element.html#ga1e5c492e5419647568f209003ab0571b">ACAPI_Element_GetElemList</a> (<a class="code hl_enumvalue" href="group___element.html#gga2502601bf26ffc7abc608f6988da4d91a97df09286f89e43fadeb4c6abbc09bc3">API_WallID</a>, &amp;wallGuids);</div>
<div class="line"> </div>
<div class="line">    GS::Array&lt;API_Neig&gt; selNeigs;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="struct_a_p_i___guid.html">API_Guid</a>&amp; guid : wallGuids) {</div>
<div class="line">        <a class="code hl_struct" href="struct_a_p_i___neig.html">API_Neig</a> neig (guid);</div>
<div class="line">        selNeigs.Push (neig);</div>
<div class="line">        <span class="comment">// Note: the following 1 commented line is equivalent to the previous 2 lines</span></div>
<div class="line">        <span class="comment">// selNeigs.PushNew (guid);</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="#gaf2d070e49c004d61909e239828b3b8f7">ACAPI_Selection_Select</a> (selNeigs, <span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga269f9b4b369bb950a85bdd10e5594db2" name="ga269f9b4b369bb950a85bdd10e5594db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga269f9b4b369bb950a85bdd10e5594db2">&#9670;&#160;</a></span>ACAPI_Selection_SetMarquee()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_SetMarquee </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___selection_info.html">API_SelectionInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>selectionInfo</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes the current marquee selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selectionInfo</td><td>[in] The parameters of the marquee to be set. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - The selectionInfo parameter is nullptr</li>
<li>APIERR_BADDATABASE - The active database is neither the floorplan, nor a section database </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to change the marquee on a floorplan or section window. The typeID field of the selectionInfo must be <code>API_MarqueePoly</code>, <code>API_MarqueeHorBox</code> or <code>API_MarqueeRotBox</code> in order to set a new marquee outline, otherwise the actual marquee will be removed. The function has no effect on the individual selection of elements. In case of <code>API_MarqueePoly</code> type marquee do not forget to release the coordinate handle passed in the selectionInfo parameter. </dd></dl>

</div>
</div>
<a id="ga83adc25d6276582c63d3662e251231d0" name="ga83adc25d6276582c63d3662e251231d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83adc25d6276582c63d3662e251231d0">&#9670;&#160;</a></span>ACAPI_Selection_SetSelectedElementNeig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Selection_SetSelectedElementNeig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> *</td>          <td class="paramname"><span class="paramname"><em>apiGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___neig.html">API_Neig</a> *</td>          <td class="paramname"><span class="paramname"><em>apiNeig</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an <a class="el" href="struct_a_p_i___guid.html">API_Guid</a> structure to an <a class="el" href="struct_a_p_i___neig.html">API_Neig</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apiGuid</td><td>[in] The GUID of the Subelement at that point. </td></tr>
    <tr><td class="paramname">apiNeig</td><td>[out] The Neig describing a point of the Element. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success.</li>
<li>APIERR_BADPARS - apiGuid or apiNeig is nullptr. </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
