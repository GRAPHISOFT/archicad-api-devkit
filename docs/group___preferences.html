<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad 28 C++ API: Add-On Preferences</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="logo.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad 28 C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group___preferences.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Add-On Preferences</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for creating, handling and deleting custom (Add-On specific) preferences, which get stored in the project file. Useful for storing Work Environment settings or some inner states of the Add-On which can be read at the next opening of the project.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4d3e27de9b7ec24efebed4fcbe571c19"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___preferences.html#ga4d3e27de9b7ec24efebed4fcbe571c19">ACAPI_SetPreferences</a> (Int32 version, GSSize nByte, const void *data)</td></tr>
<tr class="memdesc:ga4d3e27de9b7ec24efebed4fcbe571c19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves custom preferences data into the preferences file.  <br /></td></tr>
<tr class="separator:ga4d3e27de9b7ec24efebed4fcbe571c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab83813c89765ae3af5610f16b81095d2"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> (Int32 *version, GSSize *nByte, void *data)</td></tr>
<tr class="memdesc:gab83813c89765ae3af5610f16b81095d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the stored preferences of the add-on.  <br /></td></tr>
<tr class="separator:gab83813c89765ae3af5610f16b81095d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad77f425697541becd79668aee1b6b262"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a> (Int32 *version, GSSize *nByte, void *data, unsigned short *platformSign)</td></tr>
<tr class="memdesc:gad77f425697541becd79668aee1b6b262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the stored preferences of the add-on.  <br /></td></tr>
<tr class="separator:gad77f425697541becd79668aee1b6b262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b7420957faed9416620bc9243c68641"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a> (Int32 version, GSSize nByte, const void *data, unsigned short platformSign, <a class="el" href="group___project_operation.html#gaf7e72c240d18c9af9200eada2ef2944b">API_FTypeID</a> oldPlanFileID)</td></tr>
<tr class="memdesc:ga6b7420957faed9416620bc9243c68641"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines custom preferences data to be saved into older project file versions.  <br /></td></tr>
<tr class="separator:ga6b7420957faed9416620bc9243c68641"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for creating, handling and deleting custom (Add-On specific) preferences, which get stored in the project file. Useful for storing Work Environment settings or some inner states of the Add-On which can be read at the next opening of the project. </p>
<h1><a class="anchor" id="autotoc_md155"></a>
Saving Add-On data into the Preferences and the Project File</h1>
<p>This paper give hints on how to save own data into the preferences and the actual project file.</p>
<h1><a class="anchor" id="autotoc_md156"></a>
Possibilities</h1>
<p>You are allowed to save an unlimited number of bytes into the preferences file. The preferences data is also stored in in all project files.</p>
<p>Preferences data saved into a project makes it possible to open a saved project file with the same working environment. It is also used to open dialog boxes with the same settings as they had when they were closed, even if you do not quit the application.</p>
<p>If your add-on uses settings which should be preserved, please use this feature.</p>
<p>You can save your data into the preferences file using the <a class="el" href="group___preferences.html#ga4d3e27de9b7ec24efebed4fcbe571c19">ACAPI_SetPreferences</a> function and retrieve the stored preferences with <a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a>.</p>
<p>When the server application starts with a new plan, the preferences data of the add-on is available previously saved into the preferences file of the application. If you open a plan file which has preferences data stored into it by your add-on, this data overwrites the current preferences of the add-on, that is, the add-on preferences can be changed after opening a project. Remember this if you need to maintain preferences data consistency in your add-on.</p>
<p>If your add-on has different versions of preferences data in different program releases, it is recommended to set the preferences of the older formats as well in order to ensure backward compatibility. Use the <a class="el" href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a> function (Archicad only) to define your data to be saved into the specified (and earlier) plan versions instead of saving the current preferences version.</p>
<p>It is also important to handle platform specific data if the preferences can come from a plan file saved on the other platform. Use the <a class="el" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a> function instead of <a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> to retrieve the platform information too. If the platform identifier of the stored preferences does not match the actual platform, convert the data to the appropriate format.</p>
<h1><a class="anchor" id="autotoc_md157"></a>
Notes</h1>
<p>Please study the source code of the <b>DG Test</b> example to see the suggested way of handling the preferences data. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gab83813c89765ae3af5610f16b81095d2" name="gab83813c89765ae3af5610f16b81095d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab83813c89765ae3af5610f16b81095d2">&#9670;&#160;</a></span>ACAPI_GetPreferences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_GetPreferences </td>
          <td>(</td>
          <td class="paramtype">Int32 *&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GSSize *&#160;</td>
          <td class="paramname"><em>nByte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the stored preferences of the add-on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>[out] On return contains the version of the stored preferences, or 0 if no preferences were found. </td></tr>
    <tr><td class="paramname">nByte</td><td>[out] On return contains the size of the stored preferences in bytes, or 0 if no preferences were found. </td></tr>
    <tr><td class="paramname">data</td><td>[in/out] On return contains the stored preferences. This parameter can be nullptr. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - For common API errors see the API Errors document. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd><ol type="1">
<li>You can retrieve the stored preferences of your add-on. This information was previously passed onto the add-on as a parameter of the DoCommand function.</li>
<li>Setting the last parameter to nullptr means the API will return only the version number and the size of the preferences data. If the size or the version number is 0, then no preferences were stored.</li>
<li>Version information can be used to convert older preferences to the current format. In Archicad use <a class="el" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a> instead of <a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> in order to get the platform identifier of the preferences data. </li>
</ol>
</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">    Int32       version;</div>
<div class="line">    GSSize      nBytes;</div>
<div class="line">    GSPtr       pref;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> (&amp;version, &amp;nBytes, <span class="keyword">nullptr</span>);             <span class="comment">// (2) get version and size</span></div>
<div class="line">    <span class="keywordflow">if</span> (version == MY_PREFERENCES_VERSION) {                    <span class="comment">// (3) check version</span></div>
<div class="line">        pref = BMAllocatePtr (nBytes, ALLOCATE_CLEAR, 0);       <span class="comment">// allocate memory for preferences</span></div>
<div class="line">        <span class="keywordflow">if</span> (pref != <span class="keyword">nullptr</span>) {</div>
<div class="line">            <a class="code hl_function" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> (&amp;version, &amp;nBytes, pref);     <span class="comment">// get actual preferences</span></div>
<div class="line">            <span class="comment">// do something with the preferences data</span></div>
<div class="line"> </div>
<div class="line">            BMKillPtr (&amp;pref);                                  <span class="comment">// dispose allocated pointer</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="ttc" id="agroup___preferences_html_gab83813c89765ae3af5610f16b81095d2"><div class="ttname"><a href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a></div><div class="ttdeci">GSErrCode ACAPI_GetPreferences(Int32 *version, GSSize *nByte, void *data)</div><div class="ttdoc">Returns the stored preferences of the add-on.</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="gad77f425697541becd79668aee1b6b262" name="gad77f425697541becd79668aee1b6b262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad77f425697541becd79668aee1b6b262">&#9670;&#160;</a></span>ACAPI_Preferences_Platform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Preferences_Platform </td>
          <td>(</td>
          <td class="paramtype">Int32 *&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GSSize *&#160;</td>
          <td class="paramname"><em>nByte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>platformSign</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the stored preferences of the add-on. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>[out] On return contains the version of the stored preferences, or 0 if no preferences were found. </td></tr>
    <tr><td class="paramname">nByte</td><td>[out] On return contains the size of the stored preferences in bytes, or 0 if no preferences were found. </td></tr>
    <tr><td class="paramname">data</td><td>[in/out] On return contains the stored preferences. </td></tr>
    <tr><td class="paramname">platformSign</td><td>[out] On return contains the platform identifier of the stored preferences. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - For common API errors see the API Errors document. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>Use this function to retrieve the preferences data stored into the preferences or the plan file currently opened. The preferences could have been saved into the plan on the other platform; in this case it is your responsibility to convert data structures stored in opposite byte order. All the parameters can be nullptr. The data pointer should be allocated and disposed by the add-on, thus first you should call this function to retrieve only the version number and the size of the preferences data. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">Int32           version = 0;</div>
<div class="line">GSSize          nBytes = 0;</div>
<div class="line">GSPtr           pref;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>  platformSign = GS::Act_Platform_Sign;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a> (&amp;version, &amp;nBytes, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);      <span class="comment">// get version and size</span></div>
<div class="line"><span class="keywordflow">if</span> (version == MY_PREFERENCES_VERSION) {                            <span class="comment">// check version</span></div>
<div class="line">    pref = BMAllocatePtr (nBytes, ALLOCATE_CLEAR, 0);               <span class="comment">// allocate memory for preferences</span></div>
<div class="line">    <span class="keywordflow">if</span> (pref != <span class="keyword">nullptr</span>) {</div>
<div class="line">        <a class="code hl_function" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a> (&amp;version, &amp;nBytes, pref, &amp;platformSign);     <span class="comment">// get actual preferences</span></div>
<div class="line">        <span class="keywordflow">if</span> (platformSign != GS::Act_Platform_Sign) {</div>
<div class="line">            <span class="comment">// swap the necessary bytes</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// do something with the preferences data</span></div>
<div class="line">        BMKillPtr (&amp;pref);                                          <span class="comment">// dispose the allocated pointer</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup___preferences_html_gad77f425697541becd79668aee1b6b262"><div class="ttname"><a href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a></div><div class="ttdeci">GSErrCode ACAPI_Preferences_Platform(Int32 *version, GSSize *nByte, void *data, unsigned short *platformSign)</div><div class="ttdoc">Returns the stored preferences of the add-on.</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga6b7420957faed9416620bc9243c68641" name="ga6b7420957faed9416620bc9243c68641"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b7420957faed9416620bc9243c68641">&#9670;&#160;</a></span>ACAPI_Preferences_SetOldVersion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_Preferences_SetOldVersion </td>
          <td>(</td>
          <td class="paramtype">Int32&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GSSize&#160;</td>
          <td class="paramname"><em>nByte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>platformSign</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___project_operation.html#gaf7e72c240d18c9af9200eada2ef2944b">API_FTypeID</a>&#160;</td>
          <td class="paramname"><em>oldPlanFileID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines custom preferences data to be saved into older project file versions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>[in] The version of the data to be stored. </td></tr>
    <tr><td class="paramname">nByte</td><td>[in] The size of the data to be stored. </td></tr>
    <tr><td class="paramname">data</td><td>[in] The preferences data you would like to store for the specified plan version. </td></tr>
    <tr><td class="paramname">platformSign</td><td>[in] The platform identifier of the data (GS::Win_Platform_Sign, GS::Mac_Platform_Sign, GS::Mactel_Platform_Sign </td></tr>
    <tr><td class="paramname">oldPlanFileID</td><td>[in] The plan file format associated with the preferences data when saving the project into this plan version. The value of this parameter can be: </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - For common API errors see the API Errors document. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to save your own options or preferences into the preferences file of the server application or into the project file to be saved. This information can be later retrieved with <a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a> and <a class="el" href="group___preferences.html#gad77f425697541becd79668aee1b6b262">ACAPI_Preferences_Platform</a>. You can define different preferences to be saved into different plan file formats. Use this function if your add-on had incompatible preferences format in the previous versions of Archicad. Store the data in that format too indicating which plan version should use it. When the user chooses to save the plan into an older plan format, the appropriate preferences data will be stored. For more details see the Saving Add-On data into the Preferences and the Project File section. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keyword">const</span> Int32 ActVersion = 3;</div>
<div class="line"><span class="keyword">const</span> Int32 Version_in_AC8 = 2;</div>
<div class="line"><span class="keyword">const</span> Int32 Version_in_AC7 = 1;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>MyPrefs          prefsData;</div>
<div class="line"><span class="keyword">struct </span>MyPrefs_in_AC8   dataForAC8;</div>
<div class="line"><span class="keyword">struct </span>MyPrefs_in_AC7   dataForAC7;</div>
<div class="line"><span class="comment">// construct the preferences data...</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// store the actual preferences</span></div>
<div class="line"><a class="code hl_function" href="group___preferences.html#ga4d3e27de9b7ec24efebed4fcbe571c19">ACAPI_SetPreferences</a> (ActVersion, <span class="keyword">sizeof</span> (MyPrefs), &amp;prefsData);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// specify preferences to be saved into older plan file versions</span></div>
<div class="line"><a class="code hl_function" href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a> (Version_in_AC8, <span class="keyword">sizeof</span> (MyPrefs_in_AC8), &amp;dataForAC8, GS::Act_Platform_Sign, APIFType_PlanFile800);</div>
<div class="line"><a class="code hl_function" href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a> (Version_in_AC7, <span class="keyword">sizeof</span> (MyPrefs_in_AC7), &amp;dataForAC7, GS::Act_Platform_Sign, APIFType_PlanFile700);</div>
<div class="ttc" id="agroup___preferences_html_ga4d3e27de9b7ec24efebed4fcbe571c19"><div class="ttname"><a href="group___preferences.html#ga4d3e27de9b7ec24efebed4fcbe571c19">ACAPI_SetPreferences</a></div><div class="ttdeci">GSErrCode ACAPI_SetPreferences(Int32 version, GSSize nByte, const void *data)</div><div class="ttdoc">Saves custom preferences data into the preferences file.</div></div>
<div class="ttc" id="agroup___preferences_html_ga6b7420957faed9416620bc9243c68641"><div class="ttname"><a href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a></div><div class="ttdeci">GSErrCode ACAPI_Preferences_SetOldVersion(Int32 version, GSSize nByte, const void *data, unsigned short platformSign, API_FTypeID oldPlanFileID)</div><div class="ttdoc">Defines custom preferences data to be saved into older project file versions.</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga4d3e27de9b7ec24efebed4fcbe571c19" name="ga4d3e27de9b7ec24efebed4fcbe571c19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d3e27de9b7ec24efebed4fcbe571c19">&#9670;&#160;</a></span>ACAPI_SetPreferences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode ACAPI_SetPreferences </td>
          <td>(</td>
          <td class="paramtype">Int32&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GSSize&#160;</td>
          <td class="paramname"><em>nByte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves custom preferences data into the preferences file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>[in] The version of the data to be stored. </td></tr>
    <tr><td class="paramname">nByte</td><td>[in] The size of the data to be stored. </td></tr>
    <tr><td class="paramname">data</td><td>[in] The preferences data you would like to store. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to save your own options or preferences into the preferences file of the server application, and can be later retrieved with <a class="el" href="group___preferences.html#gab83813c89765ae3af5610f16b81095d2">ACAPI_GetPreferences</a>. If you store incompatible versions of preferences data in different Archicad releases, use the <a class="el" href="group___preferences.html#ga6b7420957faed9416620bc9243c68641">ACAPI_Preferences_SetOldVersion</a> function to define preferences to be saved into the older project file formats. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>