<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad 29 C++ API: Add-On Lifetime</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="logo.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad 29 C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___add_on_lifetime.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Add-On Lifetime</div></div>
</div><!--header-->
<div class="contents">

<p>Functions defining the Add-On's behavior during its lifetime, including the initial registration by Archicad, loading into memory and unloading.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___add_on_info.html">API_AddOnInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Textual description of the add-on.  <a href="struct_a_p_i___add_on_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___server_application_info.html">API_ServerApplicationInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the current server application the add-on is running under.  <a href="struct_a_p_i___server_application_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___envir_params.html">API_EnvirParams</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the different parameters of the running environment.  <a href="struct_a_p_i___envir_params.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gae6562f082fadced1355c658f7229f932" id="r_gae6562f082fadced1355c658f7229f932"><td class="memItemLeft" align="right" valign="top">typedef void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae6562f082fadced1355c658f7229f932">APIDllTermHookProc</a>(void)</td></tr>
<tr class="memdesc:gae6562f082fadced1355c658f7229f932"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler procedure for abnormal termination.  <br /></td></tr>
<tr class="separator:gae6562f082fadced1355c658f7229f932"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaf815f79406420e514a0569ab3b8e8f0b" id="r_gaf815f79406420e514a0569ab3b8e8f0b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf815f79406420e514a0569ab3b8e8f0b">API_ApplicationTypeID</a> { <a class="el" href="#ggaf815f79406420e514a0569ab3b8e8f0ba66ecee46287810da971fce43edaa6432">APIAppl_ArchiCADID</a> = 1
, <a class="el" href="#ggaf815f79406420e514a0569ab3b8e8f0ba80e031dbc5fca7030794eda86c57e7b8">APIAppl_MEPDesignerID</a> = 2
 }</td></tr>
<tr class="memdesc:gaf815f79406420e514a0569ab3b8e8f0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ID of the server application the add-on is called from.  <a href="#gaf815f79406420e514a0569ab3b8e8f0b">More...</a><br /></td></tr>
<tr class="separator:gaf815f79406420e514a0569ab3b8e8f0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7323a17897372b0fc97fcfe0874213f3" id="r_ga7323a17897372b0fc97fcfe0874213f3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a> { <a class="el" href="#gga7323a17897372b0fc97fcfe0874213f3ad544d57112e156e9ce2fbd0f70d8cb9f">APIAddon_DontRegister</a> = 0
, <a class="el" href="#gga7323a17897372b0fc97fcfe0874213f3a1d41939c287586c8641e2aa5a40b72c7">APIAddon_Normal</a> = 1
, <a class="el" href="#gga7323a17897372b0fc97fcfe0874213f3ac7a2afb6467d32fdd82663dc7c5218bf">APIAddon_Preload</a> = 2
, <a class="el" href="#gga7323a17897372b0fc97fcfe0874213f3a529fdf193612e35ccc0e7ad004544bcf">APIAddon_Unknown</a> = 9999
 }</td></tr>
<tr class="memdesc:ga7323a17897372b0fc97fcfe0874213f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the different types of add-ons.  <a href="#ga7323a17897372b0fc97fcfe0874213f3">More...</a><br /></td></tr>
<tr class="separator:ga7323a17897372b0fc97fcfe0874213f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf36d63d09853e5344932b63ee23d2bb9" id="r_gaf36d63d09853e5344932b63ee23d2bb9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf36d63d09853e5344932b63ee23d2bb9">CheckEnvironment</a> (<a class="el" href="struct_a_p_i___envir_params.html">API_EnvirParams</a> *envirParams)</td></tr>
<tr class="memdesc:gaf36d63d09853e5344932b63ee23d2bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the behavior of the add-on based on the current running environment.  <br /></td></tr>
<tr class="separator:gaf36d63d09853e5344932b63ee23d2bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d5b6a23422e44dce66728b0f4eb943e" id="r_ga3d5b6a23422e44dce66728b0f4eb943e"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3d5b6a23422e44dce66728b0f4eb943e">RegisterInterface</a> (void)</td></tr>
<tr class="memdesc:ga3d5b6a23422e44dce66728b0f4eb943e"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this function the add-on can register its services, and menu commands.  <br /></td></tr>
<tr class="separator:ga3d5b6a23422e44dce66728b0f4eb943e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8f1f7d553305c1afe5de7e4dcb66e99" id="r_gaa8f1f7d553305c1afe5de7e4dcb66e99"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> (void)</td></tr>
<tr class="memdesc:gaa8f1f7d553305c1afe5de7e4dcb66e99"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main entry point of the add-on.  <br /></td></tr>
<tr class="separator:gaa8f1f7d553305c1afe5de7e4dcb66e99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga04d82e269703a9b433002bbe20f1d3b2" id="r_ga04d82e269703a9b433002bbe20f1d3b2"><td class="memItemLeft" align="right" valign="top">GSErrCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga04d82e269703a9b433002bbe20f1d3b2">FreeData</a> (void)</td></tr>
<tr class="separator:ga04d82e269703a9b433002bbe20f1d3b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a414fcd12c93f0a947585ed03f3a7ab" id="r_ga4a414fcd12c93f0a947585ed03f3a7ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4a414fcd12c93f0a947585ed03f3a7ab">ACAPI_SetDllTermHookProc</a> (<a class="el" href="#gae6562f082fadced1355c658f7229f932">APIDllTermHookProc</a> *dllTermHookProc)</td></tr>
<tr class="memdesc:ga4a414fcd12c93f0a947585ed03f3a7ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a handler procedure for the case of abnormal termination.  <br /></td></tr>
<tr class="separator:ga4a414fcd12c93f0a947585ed03f3a7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94e03de5747d369df034c790ea8c2513" id="r_ga94e03de5747d369df034c790ea8c2513"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga94e03de5747d369df034c790ea8c2513">ACAPI_KeepInMemory</a> (bool keepIn)</td></tr>
<tr class="memdesc:ga94e03de5747d369df034c790ea8c2513"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instructs the host application to keep the add-on in the memory after execution.  <br /></td></tr>
<tr class="separator:ga94e03de5747d369df034c790ea8c2513"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions defining the Add-On's behavior during its lifetime, including the initial registration by Archicad, loading into memory and unloading. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gae6562f082fadced1355c658f7229f932" name="gae6562f082fadced1355c658f7229f932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae6562f082fadced1355c658f7229f932">&#9670;&#160;</a></span>APIDllTermHookProc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void APIDllTermHookProc(void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler procedure for abnormal termination. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Set this hook procedure with the <a class="el" href="#ga4a414fcd12c93f0a947585ed03f3a7ab">ACAPI_SetDllTermHookProc</a> function in order to be called when the application does not terminate in the normal way. Generally this function should do the same as <a class="el" href="#ga04d82e269703a9b433002bbe20f1d3b2">FreeData</a> does. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga7323a17897372b0fc97fcfe0874213f3" name="ga7323a17897372b0fc97fcfe0874213f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7323a17897372b0fc97fcfe0874213f3">&#9670;&#160;</a></span>API_AddonType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Describes the different types of add-ons. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This is the return value of the CheckEnvironment function and specifies the behavior of the current add-on in the running environment. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga7323a17897372b0fc97fcfe0874213f3ad544d57112e156e9ce2fbd0f70d8cb9f" name="gga7323a17897372b0fc97fcfe0874213f3ad544d57112e156e9ce2fbd0f70d8cb9f"></a>APIAddon_DontRegister&#160;</td><td class="fielddoc"><p>Some parameters, such as the server application version, are incorrect; the add-on will not be loaded. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga7323a17897372b0fc97fcfe0874213f3a1d41939c287586c8641e2aa5a40b72c7" name="gga7323a17897372b0fc97fcfe0874213f3a1d41939c287586c8641e2aa5a40b72c7"></a>APIAddon_Normal&#160;</td><td class="fielddoc"><p>The add-on can operate in the current environment. This is the default return value. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga7323a17897372b0fc97fcfe0874213f3ac7a2afb6467d32fdd82663dc7c5218bf" name="gga7323a17897372b0fc97fcfe0874213f3ac7a2afb6467d32fdd82663dc7c5218bf"></a>APIAddon_Preload&#160;</td><td class="fielddoc"><p>The add-on requires loading when the server application starts up, such as when it needs to perform a lengthy initialization. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga7323a17897372b0fc97fcfe0874213f3a529fdf193612e35ccc0e7ad004544bcf" name="gga7323a17897372b0fc97fcfe0874213f3a529fdf193612e35ccc0e7ad004544bcf"></a>APIAddon_Unknown&#160;</td><td class="fielddoc"><p>The add-on type is unknown. </p>
</td></tr>
</table>

</div>
</div>
<a id="gaf815f79406420e514a0569ab3b8e8f0b" name="gaf815f79406420e514a0569ab3b8e8f0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf815f79406420e514a0569ab3b8e8f0b">&#9670;&#160;</a></span>API_ApplicationTypeID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#gaf815f79406420e514a0569ab3b8e8f0b">API_ApplicationTypeID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ID of the server application the add-on is called from. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Use these data if you have to depend on the server application. Call the <a class="el" href="group___add_on_identification.html#ga323b55b8c991b2c2f9daa71b266e5172">ACAPI_AddOnIdentification_Application</a> or the <code>ACAPI_GetReleaseNumber</code> functions to get this data. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaf815f79406420e514a0569ab3b8e8f0ba66ecee46287810da971fce43edaa6432" name="ggaf815f79406420e514a0569ab3b8e8f0ba66ecee46287810da971fce43edaa6432"></a>APIAppl_ArchiCADID&#160;</td><td class="fielddoc"><p>Indicates that the server application is Archicad. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaf815f79406420e514a0569ab3b8e8f0ba80e031dbc5fca7030794eda86c57e7b8" name="ggaf815f79406420e514a0569ab3b8e8f0ba80e031dbc5fca7030794eda86c57e7b8"></a>APIAppl_MEPDesignerID&#160;</td><td class="fielddoc"><p>Indicates that the server application is MEP Designer. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga94e03de5747d369df034c790ea8c2513" name="ga94e03de5747d369df034c790ea8c2513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga94e03de5747d369df034c790ea8c2513">&#9670;&#160;</a></span>ACAPI_KeepInMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ACAPI_KeepInMemory </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepIn</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Instructs the host application to keep the add-on in the memory after execution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keepIn</td><td>[in] If true the add-on will stay in the memory. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to keep the add-on in the memory. You should call this function with true each time your add-on is called to stay in memory. The values of all your global variables stay the same between the calls to your add-on. Also, when in memory, the Initialize and the FreeData functions of your add-on are not called. See more about this topic at the Control the Load/Unload Mechanism part of the Tips and Tricks. </dd></dl>

</div>
</div>
<a id="ga4a414fcd12c93f0a947585ed03f3a7ab" name="ga4a414fcd12c93f0a947585ed03f3a7ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a414fcd12c93f0a947585ed03f3a7ab">&#9670;&#160;</a></span>ACAPI_SetDllTermHookProc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ACAPI_SetDllTermHookProc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gae6562f082fadced1355c658f7229f932">APIDllTermHookProc</a> *</td>          <td class="paramname"><span class="paramname"><em>dllTermHookProc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets a handler procedure for the case of abnormal termination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dllTermHookProc</td><td>[in] Handler function pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>Normally the FreeData function of the add-on is called before the add-on module is unloaded from the memory. However in some exceptional cases the application terminates without properly unloading the add-ons. For handling these situations you can set a hook procedure with the <a class="el" href="#ga4a414fcd12c93f0a947585ed03f3a7ab">ACAPI_SetDllTermHookProc</a> function. This might be useful if, for example, you have loaded additional modules (DLLs) from your add-on, and you want to unload them even in the case of abnormal termination. </dd></dl>

</div>
</div>
<a id="gaf36d63d09853e5344932b63ee23d2bb9" name="gaf36d63d09853e5344932b63ee23d2bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf36d63d09853e5344932b63ee23d2bb9">&#9670;&#160;</a></span>CheckEnvironment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a> CheckEnvironment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___envir_params.html">API_EnvirParams</a> *</td>          <td class="paramname"><span class="paramname"><em>envirParams</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the behavior of the add-on based on the current running environment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">envirParams</td><td>[in/out] Contains information on the environment. The add-on should also return a textual description of its purpose.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>type of add-on. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This is one of the main entry points of add-ons; each add-on should implement this function. It is called when the Add-On Manager is enumerating the add-ons during application startup. After collecting the all the information from the different add-ons, the Add-On Manager performs a dependency check, then calls the <a class="el" href="#ga3d5b6a23422e44dce66728b0f4eb943e">RegisterInterface</a> function of the "good" add-ons. The add-on can check the running environment (server application, main and sub-version), and return whether it can run under the given conditions. For example, you can disable your add-on in the demo version of Archicad; or enable/disable certain commands. This function is also the place to inform other add-ons about the availability of certain services of your add-on (see <a class="el" href="group___add_on_add_on_communication.html#ga79ba0da441937d6cbbbf85e37ec81191">ACAPI_AddOnAddOnCommunication_RegisterSupportedService</a>), and also to tell the server application that your add-on requires services of other add-ons (see <a class="el" href="group___add_on_integration.html#ga1d9af21aff689ca178ff46367ce2d62c">ACAPI_AddOnIntegration_RegisterRequiredService</a>). </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><a class="code hl_enumeration" href="#ga7323a17897372b0fc97fcfe0874213f3">API_AddonType</a> <a class="code hl_function" href="#gaf36d63d09853e5344932b63ee23d2bb9">CheckEnvironment</a> (<a class="code hl_struct" href="struct_a_p_i___envir_params.html">API_EnvirParams</a>* envir)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Fill in the necessary information</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    RSGetIndString (&amp;envir-&gt;<a class="code hl_variable" href="struct_a_p_i___envir_params.html#aee697649a2ea94a9a0ea71a932c88a08">addOnInfo</a>.<a class="code hl_variable" href="struct_a_p_i___add_on_info.html#afd2b35960456793cf413db587606a743">name</a>, 32000, 1, <a class="code hl_function" href="group___resource.html#gaf1228260879fd5622cb1e9a5284e0c50">ACAPI_GetOwnResModule</a> ());</div>
<div class="line">    RSGetIndString (&amp;envir-&gt;<a class="code hl_variable" href="struct_a_p_i___envir_params.html#aee697649a2ea94a9a0ea71a932c88a08">addOnInfo</a>.<a class="code hl_variable" href="struct_a_p_i___add_on_info.html#a7dc761071ee3297fbbbf2b893732bfee">description</a>, 32000, 2, <a class="code hl_function" href="group___resource.html#gaf1228260879fd5622cb1e9a5284e0c50">ACAPI_GetOwnResModule</a> ());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Register command services</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    GSErrCode err = <a class="code hl_function" href="group___add_on_add_on_communication.html#ga79ba0da441937d6cbbbf85e37ec81191">ACAPI_AddOnAddOnCommunication_RegisterSupportedService</a> (<span class="stringliteral">&#39;ABCD&#39;</span>, 4L);</div>
<div class="line">    <span class="keywordflow">if</span> (err != NoError)</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#gga7323a17897372b0fc97fcfe0874213f3ad544d57112e156e9ce2fbd0f70d8cb9f">APIAddon_DontRegister</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#gga7323a17897372b0fc97fcfe0874213f3a1d41939c287586c8641e2aa5a40b72c7">APIAddon_Normal</a>;</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga04d82e269703a9b433002bbe20f1d3b2" name="ga04d82e269703a9b433002bbe20f1d3b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga04d82e269703a9b433002bbe20f1d3b2">&#9670;&#160;</a></span>FreeData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode FreeData </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The termination point of the addon.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>You can use this function as the termination point of your code. It is called right before the DLL/code fragment is to be unloaded from the memory. This is the place where you can free your dynamic memory blocks, and unload the loaded modules. This function will be called in conjunction with the <a class="el" href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> function. You can be sure that the FreeData function will be called only if this function was called before, even if any error code returned in the <a class="el" href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> or the different callback functions. If your add-on has user interface, and you want to use a context sensitive help engine (you want to use not just tooltips, but help anchors too), and you registered your own help engine's path with your add-on's MDID in the Initialize function, then you should uninitialize this data here. In some exceptional cases the application terminates without calling the FreeData function of the add-ons. In these situations the system unloads the add-on modules. If you need to be called to handle these abnormal termination cases, set an <a class="el" href="#gae6562f082fadced1355c658f7229f932">APIDllTermHookProc</a> with the <a class="el" href="#ga4a414fcd12c93f0a947585ed03f3a7ab">ACAPI_SetDllTermHookProc</a> function. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode <a class="code hl_function" href="#ga04d82e269703a9b433002bbe20f1d3b2">FreeData</a> ()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// If you used RegisterAdditionalHelpLocation in Initialize function</span></div>
<div class="line">    DG::UnregisterAdditionalHelpLocation (MDID_APICD, MDID_APICD_InterfaceFunctions);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NoError;</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="gaa8f1f7d553305c1afe5de7e4dcb66e99" name="gaa8f1f7d553305c1afe5de7e4dcb66e99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">&#9670;&#160;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode Initialize </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main entry point of the add-on. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The initialization procedure has completed with success. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>You can use this function as the main entry point of your code. It is called by the library right after the DLL/code fragment has been loaded into the memory, and the communication channels are set up correctly. This is the place where you can initialize your global variables, dynamic memory blocks etc. In this function you will also have to install the callback functions for the different services you registered in the <a class="el" href="#gaf36d63d09853e5344932b63ee23d2bb9">CheckEnvironment</a> and <a class="el" href="#ga3d5b6a23422e44dce66728b0f4eb943e">RegisterInterface</a> routines. Also you can install the notification handlers here. If your add-on has user interface, and you want to use a context sensitive help engine (you want to use not just tooltips, but help anchors too), then this is the place where you can register your own help engine's path with your add-on's MDID (see DG::RegisterAdditionalHelpLocation in the example code). </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">   <span class="keywordtype">double</span> len;</div>
<div class="line">   Int32 index;</div>
<div class="line">} NType;</div>
<div class="line"> </div>
<div class="line">GSHandle** handle;</div>
<div class="line">Int32 nAlloc;</div>
<div class="line">Int32 nElem;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Called after the Add-On has been loaded into memory</span></div>
<div class="line"><span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line">GSErrCode <a class="code hl_function" href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> ()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// If the add-on has user interface and wants to use context sensitive help engine</span></div>
<div class="line">    IO::Location helpLoc;</div>
<div class="line">    <a class="code hl_function" href="group___add_on_identification.html#ga3742a840d9a7c8b768834b6306600ecd">ACAPI_GetOwnLocation</a> (&amp;helpLoc);</div>
<div class="line">    DG::RegisterAdditionalHelpLocation (MDID_DeveloperID, MDID_LocalID, &amp;helpLoc, &amp;GS::EmptyUniString, &amp;GS::EmptyUniString, <span class="keyword">nullptr</span>, &amp;GS::EmptyUniString);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Install the menu handler procedure</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    GSErrCode err = <a class="code hl_function" href="group___menu_item.html#gaf40884810b9a156a9dbded23168dbde8">ACAPI_MenuItem_InstallMenuHandler</a> (32500, MenuCommandHandler);</div>
<div class="line">    <span class="keywordflow">if</span> (err != NoError)</div>
<div class="line">        DBPrintf (<span class="stringliteral">&quot;Initialize():: ACAPI_MenuItem_InstallMenuHandler failed\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Install the change defaults notification handler procedure</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___tool_box_item.html">API_ToolBoxItem</a> toolBoxItem {};</div>
<div class="line"> </div>
<div class="line">    toolBoxItem.<a class="code hl_variable" href="struct_a_p_i___tool_box_item.html#aafe5c6f1486e5da87a849afddd61bb9b">type</a> = <a class="code hl_enumvalue" href="group___element.html#gga2502601bf26ffc7abc608f6988da4d91a74b48da6204a8f92dbeb1cf455bd6515">API_ZombieElemID</a>;                <span class="comment">// for all types</span></div>
<div class="line">    err = <a class="code hl_function" href="group___element.html#ga768940c37ff87f92dce41b8c138476dc">ACAPI_Element_CatchChangeDefaults</a> (&amp;toolBoxItem, APIDefaultsChangeHandler);</div>
<div class="line">    <span class="keywordflow">if</span> (err == NoError) {</div>
<div class="line">        err = <a class="code hl_function" href="group___project_operation.html#gacc5ea19d38befe2e1da1d07f51ce2fef">ACAPI_ProjectOperation_CatchProjectEvent</a> (APINotify_Close, APIProjectEventHandler);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}   <span class="comment">// Initialize</span></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ga3d5b6a23422e44dce66728b0f4eb943e" name="ga3d5b6a23422e44dce66728b0f4eb943e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3d5b6a23422e44dce66728b0f4eb943e">&#9670;&#160;</a></span>RegisterInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode RegisterInterface </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this function the add-on can register its services, and menu commands. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed with success. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function registers the different services of your add-on: menu commands, file types, commands other add-on can call, toolbox items, or library part subtypes. Here you can obtain information on the server application, on the protection, and the availability of the services of other add-ons as well; and adjust the registration depending on this information. The actual callback functions which handle the events and notifications coming from the server application are installed in the Initialize function of your add-on. The actual callback functions which handle the events and notifications coming from the server application are installed in the <a class="el" href="#gaa8f1f7d553305c1afe5de7e4dcb66e99">Initialize</a> function of your add-on. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode <a class="code hl_function" href="#ga3d5b6a23422e44dce66728b0f4eb943e">RegisterInterface</a> ()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Register menu</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    GSErrCode err = <a class="code hl_function" href="group___menu_item.html#gaec79ce2178f5bb5482da171a49ba88ef">ACAPI_MenuItem_RegisterMenu</a> (32500, 32501, <a class="code hl_enumvalue" href="group___add_on_integration.html#ggae7782179a03e5a2f34a4940b46b86623ab88951f758b321ff3592d7802f350d33">MenuCode_Options1</a>, MenuFlag_Default);</div>
<div class="line">    <span class="keywordflow">if</span> (err != NoError)</div>
<div class="line">        <span class="keywordflow">return</span> err;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Register an IO</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    err = <a class="code hl_function" href="group___add_on_integration.html#ga98bb66d70f3f8ba9ec38e3119795828c">ACAPI_AddOnIntegration_RegisterFileType</a> (1, <span class="stringliteral">&#39;GSAC&#39;</span>, <span class="stringliteral">&#39; DWF&#39;</span>, <span class="stringliteral">&quot;dwf&quot;</span>, 0, 32500, 1,</div>
<div class="line">                                   SaveAs2DSupported + Open2DSupported + Merge2DSupported);</div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}   <span class="comment">// RegisterInterface</span></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
