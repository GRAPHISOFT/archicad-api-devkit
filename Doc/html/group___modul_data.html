<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Archicad C++ API" />
<meta property="og:image" content="logo.svg" />
<meta property="og:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<meta property="og:url" content="https://archicadapi.graphisoft.com/documentation/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="logo.svg" />
<meta name="twitter:title" content="Archicad C++ API" />
<meta name="twitter:description" content="Archicad Development Kit Documentation, best practices, example codes and information hub." />
<!-- END twitter metadata -->
<title>Archicad C++ API: Custom Modul Data</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="https://fonts.cdnfonts.com/css/proxima-nova-2" rel="stylesheet">
<link rel="icon" href="logo.svg" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Archicad C++ API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group___modul_data.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Custom Modul Data</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for creating, handling and deleting custom (Add-On specific) Modul Data. Differs from User Data in not being attached to specific elements or element groups. This is a legacy technology, please use Add-On Objects instead.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control information of a custom data section saved into the project file.  <a href="struct_a_p_i___modul_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga77ec2f1716114b35f80ac39a9ade74eb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#ga77ec2f1716114b35f80ac39a9ade74eb">API_MDSetCmd</a> { <b>APIMDSetMerge_TW</b> = 11
, <b>APIMDSetMerge_HLM</b> = 12
, <b>APIMDSetMerge_Merge</b> = 13
 }</td></tr>
<tr class="memdesc:ga77ec2f1716114b35f80ac39a9ade74eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">ModulData operation code.  <a href="group___modul_data.html#ga77ec2f1716114b35f80ac39a9ade74eb">More...</a><br /></td></tr>
<tr class="separator:ga77ec2f1716114b35f80ac39a9ade74eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac4b27ed56095c24c6782e08093bd8231"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a> (const <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *info, const GS::UniString &amp;modulName=&quot;&quot;)</td></tr>
<tr class="memdesc:gac4b27ed56095c24c6782e08093bd8231"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves a custom data section into the project database.  <br /></td></tr>
<tr class="separator:gac4b27ed56095c24c6782e08093bd8231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab346d528b7b7a741bca50d52fd8806f2"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a> (<a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *info, const GS::UniString &amp;modulName=&quot;&quot;)</td></tr>
<tr class="memdesc:gab346d528b7b7a741bca50d52fd8806f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns information on the custom data section stored in the project database.  <br /></td></tr>
<tr class="separator:gab346d528b7b7a741bca50d52fd8806f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68677e58ce2588776f5acf3d6bd49b2a"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> (<a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *info, const GS::UniString &amp;modulName=&quot;&quot;)</td></tr>
<tr class="memdesc:ga68677e58ce2588776f5acf3d6bd49b2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the data section stored in the project database.  <br /></td></tr>
<tr class="separator:ga68677e58ce2588776f5acf3d6bd49b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a3087986428b4dd1448cbdd291a8594"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#ga4a3087986428b4dd1448cbdd291a8594">ACAPI_ModulData_GetList</a> (GS::Array&lt; GS::UniString &gt; *modulNameList)</td></tr>
<tr class="memdesc:ga4a3087986428b4dd1448cbdd291a8594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of names of the custom data sections stored in the project database.  <br /></td></tr>
<tr class="separator:ga4a3087986428b4dd1448cbdd291a8594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b2bd8e0d6d3de5150136bd690c5edf1"><td class="memItemLeft" align="right" valign="top">GSErrCode __ACENV_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___modul_data.html#ga7b2bd8e0d6d3de5150136bd690c5edf1">ACAPI_ModulData_Delete</a> (const GS::UniString &amp;modulName=&quot;&quot;)</td></tr>
<tr class="memdesc:ga7b2bd8e0d6d3de5150136bd690c5edf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the custom data section stored in the project database.  <br /></td></tr>
<tr class="separator:ga7b2bd8e0d6d3de5150136bd690c5edf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for creating, handling and deleting custom (Add-On specific) Modul Data. Differs from User Data in not being attached to specific elements or element groups. This is a legacy technology, please use Add-On Objects instead. </p>
<h1><a class="anchor" id="autotoc_md131"></a>
ModulData Manager</h1>
<p>It allows each add-on to own custom data sections in Archicad project files. No limitation is imposed on the structure or content, not even on the amount of saved bytes. Archicad knows nothing about its internal format, it just preserves a number of bytes in the project file and returns them upon requests.</p>
<p>Data sections are identified uniquely by the add-on's modul ID (<a class="el" href="md__common_doxygen_files_2_articles_2_required___resources.html#RequiredResources">'MDID'</a>) and an optional modul name string. This means the one data per add-on limitation of previous versions has been dissolved.</p>
<h2><a class="anchor" id="autotoc_md132"></a>
Functions</h2>
<p>All of the ModulData Manager functions begin with the <b>ACAPI_ModulData_</b> prefix. They are as follows:</p>
<ul>
<li><a class="el" href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a> <br  />
</li>
<li><a class="el" href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a> <br  />
</li>
<li><a class="el" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> <br  />
</li>
<li><a class="el" href="group___modul_data.html#ga4a3087986428b4dd1448cbdd291a8594">ACAPI_ModulData_GetList</a> <br  />
</li>
<li><a class="el" href="group___modul_data.html#ga7b2bd8e0d6d3de5150136bd690c5edf1">ACAPI_ModulData_Delete</a></li>
</ul>
<p>Refer to the <b>ModulData Manager</b> example project to see detailed examples on using these functions.</p>
<h2><a class="anchor" id="autotoc_md133"></a>
Merging custom data sections</h2>
<p>In certain situations modules of the same add-on can conflict with each other. When merging another plan into the project, it might be necessary to keep both the original and the incoming modul data, and to combine them together. Since the host application does not know the content of the modules, the owner add-on is requested to resolve the conflict.</p>
<p>For this purpose the add-on needs to implement an APIModulDataMergeHandlerProc callback handler function, and pass the function pointer to Archicad with the <a class="el" href="group___add_on_integration.html#gad7e5bede2492f4b89d59ea514c0b884e">ACAPI_AddOnIntegration_InstallModulDataMergeHandler</a> in the Initialize routine. It is also necessary to inform Archicad that the add-on is prepared for merging module data: this can be done with the <a class="el" href="group___add_on_integration.html#gafe749ba332ce6af273c2071185e63230">ACAPI_AddOnIntegration_RegisterModulDataHandler</a> function called from RegisterInterface.</p>
<p>In Teamwork mode it is also possible that the same module data is modified by the owner and by other team members. In this case the local and the server version of the data is conflicting at synchronization, and the add-on's APIModulDataMergeHandlerProc is called to adjust the proper data.</p>
<p>When Archicad calls the handler function, the <a class="el" href="group___modul_data.html#ga77ec2f1716114b35f80ac39a9ade74eb">API_MDSetCmd</a> moduldata event codes inform you about the type of the actual operation:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Event Code   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>APIMDSetMerge_TW</code>   </td><td class="markdownTableBodyNone">The data sections should be merged because of a Teamwork operation (e.g. Receive changes).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>APIMDSetMerge_HLM</code>   </td><td class="markdownTableBodyNone">The data section from a Hotlinked module should be merged into the main database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>APIMDSetMerge_Merge</code>   </td><td class="markdownTableBodyNone">The data section should be merged from a file which was merged into the main project, or from a paste or Drag&amp;Drop operation.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md134"></a>
Moduldata versions</h2>
<p>The <code><a class="el" href="struct_a_p_i___modul_data.html" title="Control information of a custom data section saved into the project file.">API_ModulData</a></code> structure contains a version number. If your data structure has to be changed, increase the version number. Upon retrieving the data section, check the version information and provide backward compatibility if possible.</p>
<p>Refer to the <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> structure for more details.</p>
<h2><a class="anchor" id="autotoc_md135"></a>
Moduldata platforms</h2>
<p>Since Archicad is a multi-platform application, all data written into the project file should be readable on the opposite platform too. As byte ordering is different on the Windows and on the Macintosh, for the correct interpretation the add-on needs to know on which platform the data was created. If the platform code differs from the actual platform, perform the necessary byte swapping operations using the <a class="el" href="md__common_doxygen_files_2_articles_2_g_s_root___s_t_l___comparison.html#gsroot">GSRoot</a> module, or use Memory Channel to read and write the custom data.</p>
<p>Refer to the <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> structure for more details.</p>
<p>Saving data into old format project</p>
<p>If the structure of the custom data has changed since the previous version, you need to implement an APIModulDataSaveOldFormatHandlerProc callback function to be able to convert your modules when saving into an older format project. In order to be called this handler, the function pointer must be passed with <a class="el" href="group___add_on_integration.html#ga2a2ed3f7c697aec427a124afecb981f2">ACAPI_AddOnIntegration_InstallModulDataSaveOldFormatHandler</a>, and the modul data handling feature must be registered with <a class="el" href="group___add_on_integration.html#gafe749ba332ce6af273c2071185e63230">ACAPI_AddOnIntegration_RegisterModulDataHandler</a>.</p>
<p>When Archicad calls this function, the add-on should create the converted data according to the given plan file format, and pass it back to the application. The old format data should not be stored with <a class="el" href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a>, nor the current data needs to be deleted or modified during the project save operation.</p>
<p>If the add-on does not install this converter callback routine, the available current format module data is saved into the old version project as well.</p>
<h2><a class="anchor" id="autotoc_md136"></a>
Other comments</h2>
<p>Notice that it is not recommended to store unique ID-type references to Archicad elements in the module data; for this purpose try to use the <a class="el" href="group___element_set.html">Element Set Manager</a> service instead.</p>
<h2><a class="anchor" id="autotoc_md137"></a>
The Modul Data - Saving Custom Data as a Section of the Archicad Project File</h2>
<p>Every add-on can save custom data into an Archicad single project, teamwork project, or hotlink module. This lets the add-on programmers have a custom - unlimited length - data section in the project. The benefit of this feature is that it spares the Archicad users from having to care about many separate files that belong to a project and are needed by add-ons, when the project file changes its location (by copy, paste, email, ftp, etc).</p>
<p>The custom section of the project file can be anything the add-on programmer desires to save for his/her add-on, but special attention is needed for the issues of maintaining this data when the add-on is active, and also, the correct byte order, if the add-on was developed for multiplatform usage.</p>
<hr  />
<p><b>Trick:</b> You can delete add-on data from a project file following these steps:</p>
<ol type="1">
<li>Quit Archicad if it's running.</li>
<li>Delete or remove the add-on from its location. <br  />
 (Usually the Add-Ons folder of your Archicad installation directory.)</li>
<li>Start up Archicad, and open the Project file in Archicad that you want to erase the add-on data from.</li>
<li>Locate the "Archicad Temporary Folder" <br  />
 (It is on the Temporary Volume, which can be set through the Options/Preferences/Data Safety menu, Temporary Folder Location button (or the applying localized version of it.) Usually it's on the C: drive on Windows, or in the System Folder of the System Drive on the Macintosh.)</li>
<li>Switch into the <code>APIData</code> subfolder.</li>
<li>Locate the tmp file that belongs to your add-on. <br  />
 (The corresponding file should contain the filename of your add-on at its 64th byte.)</li>
<li>Delete the located file.</li>
<li>Save the project in Archicad.</li>
</ol>
<p>At the next opening of the project, your add-on data will not be present. This way you can decrease the load time of Archicad, test the initialization of an add-on with no add-on data present, or get rid of add-on data for add-ons you don't use any more. <br  />
</p>
<p><b>Warning: The data deleted following this method will be lost and cannot be recovered!</b> </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga77ec2f1716114b35f80ac39a9ade74eb" name="ga77ec2f1716114b35f80ac39a9ade74eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga77ec2f1716114b35f80ac39a9ade74eb">&#9670;&#160;</a></span>API_MDSetCmd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___modul_data.html#ga77ec2f1716114b35f80ac39a9ade74eb">API_MDSetCmd</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ModulData operation code. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This value is passed as a parameter to the APIModulDataMergeHandlerProc callback function. When the ModulData Manager notifies your add-on, this code tells you the type of operation your add-on is called for. The <code>APIMDSetMerge_Merge</code> code means that the notification is posted because of the database must be updated; invoked by the Merge or Copy commands. The APIMDSetMerge_HLM and APIMDSetMerge_TW means the notification is posted because of the databases must be merged; invoked by Teamwork (Send Changes, Receive Changes), or Place Hotlink Module commands, respectively. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7b2bd8e0d6d3de5150136bd690c5edf1" name="ga7b2bd8e0d6d3de5150136bd690c5edf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b2bd8e0d6d3de5150136bd690c5edf1">&#9670;&#160;</a></span>ACAPI_ModulData_Delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_ModulData_Delete </td>
          <td>(</td>
          <td class="paramtype">const GS::UniString &amp;&#160;</td>
          <td class="paramname"><em>modulName</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the custom data section stored in the project database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modulName</td><td>[in] Identifier name of the modul data (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The information was returned successfully.</li>
<li>APIERR_NOMODULEDATA - No custom data section is saved into the project file identified by the add-on's unique modul ID and the modulName parameter. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to delete the custom data section embedded in the project database. Calling <a class="el" href="group___modul_data.html#ga7b2bd8e0d6d3de5150136bd690c5edf1">ACAPI_ModulData_Delete</a> is equivalent to <a class="el" href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a> (nullptr). This function is a non-undoable data structure modifier function. See more details on this topic at Command Overview. </dd></dl>

</div>
</div>
<a id="ga68677e58ce2588776f5acf3d6bd49b2a" name="ga68677e58ce2588776f5acf3d6bd49b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga68677e58ce2588776f5acf3d6bd49b2a">&#9670;&#160;</a></span>ACAPI_ModulData_Get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_ModulData_Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const GS::UniString &amp;&#160;</td>
          <td class="paramname"><em>modulName</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the data section stored in the project database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>[out] Contains the the custom data stored in the project file on return. </td></tr>
    <tr><td class="paramname">modulName</td><td>[in] Identifier name of the modul data (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The function has completed successfully.</li>
<li>APIERR_BADPARS - The info parameter is nullptr.</li>
<li>APIERR_NOMODULEDATA - No custom data section is saved into the project file identified by the add-on's unique modul ID and the modulName parameter. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to retrieve the data bytes of the custom data section embedded into the project database, identified with the given modulName.<ul>
<li>Always check the platformSign returned in the <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> structure. Call the necessary byte swapping methods to ensure correct data format. Refer to the GSRoot documentation to have further details on the byte swapping methods.</li>
<li>Always check the dataVersion returned in the <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> structure. Old data formats should be handled to keep backward compatibility (see also APIModulDataSaveOldFormatHandlerProc). Archicad allocates the target buffer in the dataHdl field of info ; the caller add-on is responsible to dispose it with BMKillHandle. In order to check whether there is moduldata with the specified identifier stored into the current project, it is recommended to use the <a class="el" href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a> function, which does not retrieves the data itself but the version and platform information. </li>
</ul>
</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode MyDataClass::LoadFromModulData (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a>  info;</div>
<div class="line">    GSErrCode      err;</div>
<div class="line"> </div>
<div class="line">    BNZeroMemory (&amp;info, <span class="keyword">sizeof</span> (<a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a>));</div>
<div class="line">    err = <a class="code hl_function" href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a> (&amp;info, <span class="stringliteral">&quot;MyFirstDataBlock&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (err != NoError) {</div>
<div class="line">        <span class="keywordflow">if</span> (err == APIERR_NOMODULEDATA)</div>
<div class="line">            err = NoError;</div>
<div class="line">        <span class="keywordflow">return</span> err;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    err = <a class="code hl_function" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> (&amp;info, <span class="stringliteral">&quot;MyFirstDataBlock&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (err == NoError &amp;&amp; info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa75d22a450fac1c7e432c8a699f8f891">dataVersion</a> == 1) {</div>
<div class="line">        myDataClassIntMember = *(<span class="keyword">reinterpret_cast&lt;</span>Int32*<span class="keyword">&gt;</span> (*info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a>));</div>
<div class="line">        <span class="keywordflow">if</span> (info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#a41a0671ef7874abc1f9d8d7c15bc3dae">platformSign</a> != GS::Act_Platform_Sign) {   <span class="comment">// swap data bytes</span></div>
<div class="line">            IVLong ((GS::PlatformSign) info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#a41a0671ef7874abc1f9d8d7c15bc3dae">platformSign</a>, &amp;myDataClassIntMember);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    BMKillHandle (&amp;info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a>);</div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}</div>
<div class="ttc" id="agroup___modul_data_html_ga68677e58ce2588776f5acf3d6bd49b2a"><div class="ttname"><a href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_ModulData_Get(API_ModulData *info, const GS::UniString &amp;modulName=&quot;&quot;)</div><div class="ttdoc">Returns the data section stored in the project database.</div></div>
<div class="ttc" id="agroup___modul_data_html_gab346d528b7b7a741bca50d52fd8806f2"><div class="ttname"><a href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_ModulData_GetInfo(API_ModulData *info, const GS::UniString &amp;modulName=&quot;&quot;)</div><div class="ttdoc">Returns information on the custom data section stored in the project database.</div></div>
<div class="ttc" id="astruct_a_p_i___modul_data_html"><div class="ttname"><a href="struct_a_p_i___modul_data.html">API_ModulData</a></div><div class="ttdoc">Control information of a custom data section saved into the project file.</div><div class="ttdef"><b>Definition:</b> APIdefs_ModulData.h:60</div></div>
<div class="ttc" id="astruct_a_p_i___modul_data_html_a41a0671ef7874abc1f9d8d7c15bc3dae"><div class="ttname"><a href="struct_a_p_i___modul_data.html#a41a0671ef7874abc1f9d8d7c15bc3dae">API_ModulData::platformSign</a></div><div class="ttdeci">unsigned short platformSign</div><div class="ttdoc">Byte ordering in data storage (can be either GS::Win_Platform_Sign, GS::Mac_Platform_Sign or GS::Mact...</div><div class="ttdef"><b>Definition:</b> APIdefs_ModulData.h:70</div></div>
<div class="ttc" id="astruct_a_p_i___modul_data_html_aa75d22a450fac1c7e432c8a699f8f891"><div class="ttname"><a href="struct_a_p_i___modul_data.html#aa75d22a450fac1c7e432c8a699f8f891">API_ModulData::dataVersion</a></div><div class="ttdeci">Int32 dataVersion</div><div class="ttdoc">Data version; use this for backward compatibility.</div><div class="ttdef"><b>Definition:</b> APIdefs_ModulData.h:65</div></div>
<div class="ttc" id="astruct_a_p_i___modul_data_html_aa8df535464e28f9592b75bb47ede19dc"><div class="ttname"><a href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">API_ModulData::dataHdl</a></div><div class="ttdeci">GSHandle dataHdl</div><div class="ttdoc">User specified data (cannot be nullptr).</div><div class="ttdef"><b>Definition:</b> APIdefs_ModulData.h:76</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="gab346d528b7b7a741bca50d52fd8806f2" name="gab346d528b7b7a741bca50d52fd8806f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab346d528b7b7a741bca50d52fd8806f2">&#9670;&#160;</a></span>ACAPI_ModulData_GetInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_ModulData_GetInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const GS::UniString &amp;&#160;</td>
          <td class="paramname"><em>modulName</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns information on the custom data section stored in the project database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>[out] The version and platform information of the stored moduldata. </td></tr>
    <tr><td class="paramname">modulName</td><td>[in] Identifier name of the modul data (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The information was returned successfully.</li>
<li>APIERR_BADPARS - The info parameter is nullptr.</li>
<li>APIERR_NOMODULEDATA - No custom data section is saved into the project file identified by the add-on's unique modul ID and the modulName parameter. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to retrieve version and platform information on the custom data section embedded in the project database, identified with the given modulName. In order to get the stored data itself, use the <a class="el" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> function. </dd></dl>

</div>
</div>
<a id="ga4a3087986428b4dd1448cbdd291a8594" name="ga4a3087986428b4dd1448cbdd291a8594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a3087986428b4dd1448cbdd291a8594">&#9670;&#160;</a></span>ACAPI_ModulData_GetList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_ModulData_GetList </td>
          <td>(</td>
          <td class="paramtype">GS::Array&lt; GS::UniString &gt; *&#160;</td>
          <td class="paramname"><em>modulNameList</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a list of names of the custom data sections stored in the project database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modulNameList</td><td>[out] List of moduldata names stored by the add-on into the current project. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - The information was returned successfully.</li>
<li>APIERR_BADPARS - The modulNameList parameter is nullptr. </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to retrieve a list of names of the custom data sections embedded by the add-on in the project database. In order to get the stored data itself, use the <a class="el" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> function using the names retrieved in the list. Empty list means no custom data section is stored in the project. If the project was saved in earlier format than Archicad 13, the modul name of the stored custom data is empty string (""). </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GS::Array&lt;GS::UniString&gt; modulNameList;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group___modul_data.html#ga4a3087986428b4dd1448cbdd291a8594">ACAPI_ModulData_GetList</a> (&amp;modulNameList);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (GS::Array&lt;GS::UniString&gt;::ConstIterator it = modulNameList.Enumerate (); it != <span class="keyword">nullptr</span>; ++it) {</div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a> modulData;</div>
<div class="line">    BNZeroMemory (&amp;modulData, <span class="keyword">sizeof</span> (<a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a>));</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> (&amp;modulData, *it) == NoError) {</div>
<div class="line">        <span class="comment">// do something with the moduldata</span></div>
<div class="line">    }</div>
<div class="line">    BMKillHandle (&amp;modulData.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___modul_data_html_ga4a3087986428b4dd1448cbdd291a8594"><div class="ttname"><a href="group___modul_data.html#ga4a3087986428b4dd1448cbdd291a8594">ACAPI_ModulData_GetList</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_ModulData_GetList(GS::Array&lt; GS::UniString &gt; *modulNameList)</div><div class="ttdoc">Returns a list of names of the custom data sections stored in the project database.</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="gac4b27ed56095c24c6782e08093bd8231" name="gac4b27ed56095c24c6782e08093bd8231"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4b27ed56095c24c6782e08093bd8231">&#9670;&#160;</a></span>ACAPI_ModulData_Store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GSErrCode __ACENV_CALL ACAPI_ModulData_Store </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_p_i___modul_data.html">API_ModulData</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const GS::UniString &amp;&#160;</td>
          <td class="paramname"><em>modulName</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves a custom data section into the project database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>[in] The module data to store. It also includes platform and version information. </td></tr>
    <tr><td class="paramname">modulName</td><td>[in] Identifier name of the modul data (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>NoError - the function completed successfully</li>
<li>APIERR_BADPARS - the passed dataHdl parameter is nullptr</li>
<li>APIERR_BADPLATFORMSIGN - the platformSign passed in info is not valid</li>
<li>APIERR_NOMODULEDATA - no custom data section is saved into the project file to be deleted</li>
<li>APIERR_MEMFULL - failed memory allocation</li>
<li>APIERR_GENERAL - a general error </li>
</ul>
</dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function is used to embed a custom data section into the project database. The data section in the project is identified uniquely using the 'MDID' of the caller add-on and the passed modulName identifier. The dataHdl handle has to be allocated and released using the c%20Memory%20Manager"&gt; BM memory manager functions of the GSRoot module. The data content can be copied into the handle directly, or you can use the allocated memory block as a memory channel (see IO::MemoryOChannel). In order to remove the saved module data from the project, you can simply pass nullptr pointer in the info parameter. The same effect can be achieved with the <a class="el" href="group___modul_data.html#ga7b2bd8e0d6d3de5150136bd690c5edf1">ACAPI_ModulData_Delete</a> function. To retrieve the stored section use the <a class="el" href="group___modul_data.html#gab346d528b7b7a741bca50d52fd8806f2">ACAPI_ModulData_GetInfo</a> and <a class="el" href="group___modul_data.html#ga68677e58ce2588776f5acf3d6bd49b2a">ACAPI_ModulData_Get</a> functions. You can also get a list of names of all modules stored by the add-on with the <a class="el" href="group___modul_data.html#ga4a3087986428b4dd1448cbdd291a8594">ACAPI_ModulData_GetList</a> function. If you need to save different format moduldata back into previous version project file, you should implement an APIModulDataSaveOldFormatHandlerProc callback function, which prepares the necessary data in the format corresponding to the project version. You might also need to merge data of the modules conflicting due to a merge or Teamwork receive operation. In order to properly resolve the conflicts you can implement an APIModulDataMergeHandlerProc callback function. For further details refer to the ModulData Manager overview. This function is a non-undoable data structure modifier function. See more details on this topic at Command Overview. </dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">GSErrCode MyDataClass::SaveIntoModulData (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    GSErrCode err = NoError;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a> info;</div>
<div class="line">    BNZeroMemory (&amp;info, <span class="keyword">sizeof</span> (<a class="code hl_struct" href="struct_a_p_i___modul_data.html">API_ModulData</a>));</div>
<div class="line">    info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa75d22a450fac1c7e432c8a699f8f891">dataVersion</a> = 1;</div>
<div class="line">    info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#a41a0671ef7874abc1f9d8d7c15bc3dae">platformSign</a> = GS::Act_Platform_Sign;</div>
<div class="line">    info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a> = BMAllocateHandle (<span class="keyword">sizeof</span> (myDataClassIntMember), 0, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line">        *(<span class="keyword">reinterpret_cast&lt;</span>Int32*<span class="keyword">&gt;</span> (*info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a>)) = myDataClassIntMember;</div>
<div class="line">        err = <a class="code hl_function" href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a> (&amp;info, <span class="stringliteral">&quot;MyFirstDataBlock&quot;</span>);</div>
<div class="line">        BMKillHandle (&amp;info.<a class="code hl_variable" href="struct_a_p_i___modul_data.html#aa8df535464e28f9592b75bb47ede19dc">dataHdl</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        err = APIERR_MEMFULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> err;</div>
<div class="line">}</div>
<div class="ttc" id="agroup___modul_data_html_gac4b27ed56095c24c6782e08093bd8231"><div class="ttname"><a href="group___modul_data.html#gac4b27ed56095c24c6782e08093bd8231">ACAPI_ModulData_Store</a></div><div class="ttdeci">GSErrCode __ACENV_CALL ACAPI_ModulData_Store(const API_ModulData *info, const GS::UniString &amp;modulName=&quot;&quot;)</div><div class="ttdoc">Saves a custom data section into the project database.</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>